<HTML>
<HEAD>
<TITLE>寵物計算機</TITLE>

<STYLE type="text/css">

</STYLE>

<SCRIPT language="JavaScript">
<!--
//待施工:
//全寵物能力範圍表(可加註五圍頂底成長), 滿檔寵物各能力下限表, 寵物成長模擬器
//BUG:
//Yuna 90	115	36	45	30	2	4	7	3	6
//wrong alignment at 99.98 spi
//TO DO LIST:
//get rid of extra space on the right out calc table
//group all language specific strings together
//fix up messy array structure
//allow ordering, perhaps multi-lv (2 is enough?)
//append string at beginning of each invalid/no solution input line to identify them as such
//* Implement non-lv1 calculations
//* Sim
//* Detailed Data (location, attribute, eff/non-eff against etc)
//Random Generate xx num of particular choice - add to textarea field
//* Testing input list to see fit for which ptTypes?
//*ranking of different races?

//How to deal with padding?
// - check length of max, pad all other based on this limit,
// - finally concatenate all pieces of the string together
//Should I check for total length? If length too long, remove padding accordingly
// - need to able to choose from "&nbsp;|&nbsp;" or "|"

//each solution can have a probability
//***listing probability will severely restrict spacing*** ' 78%' <- take 4 spaces
//to accommodate this, must rid of commas
//to calculate probability, need expand each set of solutions, then tally
//probability of the subsets.

//option to print/calculate probability and BPSum

// var           var                var??        var        fixed       fixed
//[ord] [        stat          ] | [  BP   ] |[minL~maxL]| [cfloss]  | [maxLoss]
//  #9: 102 168 40 39 29 103 100 | 5 6 5 3 1 |  -8 ~  -9 | 0,0,1,0,0 | 4,4,4,4,4
// #10: 103 170 40 38 30 103 100 | 5 6 4 3 1 |  -7 ~  -8 | 0,0,3,0,0 | 4,4,4,4,4
// #11:  97  75 40 38 30 103 100 | 4 6 4 3 2 |  -8 ~  -9 | 3,0,3,0,0 | 4,2,4,2,2

//How much data does any given pt has?
//race, BPCl are global
//order, stat[5], spi, rev, BP[5], lossMin, lossMax, cfLossSummary, maxLossSummary,
//and list of solutions[n], anything else? grIndexMax grIndexMin
//no need variable to store num of solution, just check solution length.

//write a method to compare two sets of stats?

//for each solution, need list class[5], loss, cfLoss[5] and maxLoss[5]
//stat[5], spi, rev and BP[5] are derived, later printed to 2 decide places
function sol(classes, grIndex) {
  this.gr = grIndex
  this.cl = new Array(5)
  for (var cla in classes) this.cl[cla] = classes[cla]
  //formula is: (baseBP+(40+gr)/1000*(level-1)), gr=0,1,2,3,4,5
  solBase = (base*1000 + (40 + this.gr)*(level-1))/1000
  this.BP = new Array(5)
  this.stat = new Array(5)
  this.loss = undefined
  this.cfLoss = new Array(0,0,0,0,0)
  this.maxLoss = new Array(5)
  for (var ba in this.cl) {
    this.BP[ba] = this.cl[ba]*solBase
    this.stat[ba] = stat(ba,this.cl)*solBase+20
  }
  this.spi = spi(this.cl)*solBase + 100
  this.rev = rev(this.cl)*solBase + 100
  return this
}

//stats are stored with base 20 removed
//BP and rec/spi are optional, and checked against if inputed
//only integer values matter
function pt(values) {
  var vLen = values.length
  doCheckBP = false
  if (values[0]==undefined || vLen<5) return this
  this.sols = new Array()
  this.stat = new Array(5)
  for (var j=0;j<5;j++) this.stat[j] = values[j]-20
  if (vLen>5 && vLen<10) {
    this.spi = values[5]
    if (vLen>6) this.rev = values[6]
    return this
  }
  //if length is  6, assume stat + spi
  //if length is  7, assume stat + spi + rev
  //if length is  8 or 9, only consider first 7
  //if length is 10, assume stat + BP,
  //if length is 11, assume stat + spi + BP (!!!could be stat + BP + BPSum!!)
  //could be stat+bp+ (-x~-x)
  //if length is 12, assume stat + spi + rev + BP(!!!could be stat + spi + BP + BPSum!!!)
  //could be stat+bp+ (-x~-x)
  //if length is 13, assume stat + spi + rev + BP + BPSum
  //if length is over 12, only consider first 12
  //move can be calculated by -10 from vLen, then set max to 2
  if (vLen>=10) {
    doCheckBP = true
    var move = Math.min(vLen-10,2) + 5
    if (vLen==11 || vLen==12) {
      //assumed values[5] is spi, now check assumption (move is now 6)
      //assumption is WRONG if last number equates to sum of the 5 numbers before it
      var sum = 0
      for (var j=(vLen-6);j<(vLen-1);j++) sum+=values[move+j]
      if (sum==values[vLen-1]) move--
      else if (values[5] > 20) {
        this.spi = values[5]
        if (vLen==12) this.rev=values[6]
      }
      else {
        move-= (vLen-10)
      }
    }
    if (vLen>11 && values[5]>20) this.spi = values[5]
    if (vLen>12 && values[6]>20) this.rev = values[6] //assume stat+spi+rev+BP+rubbish
    this.BP = new Array(5)
    for (var b=0;b<5;b++) this.BP[b] = values[b+move]
  }
  return this
}


// here starts some horrible programming
// re:
// 0 is stat given
// 1 indicate whether solution exist
// 2 is lossMin
// 3 is lossMax
// 4 is cfLossSummary
// 5 is maxLossSummary
// 6 is array of cor solutions
// 6[a][0][0~4] is class for solution a
// 6[a][1] is total loss for solution a
// 6[a][2][0~4] is cfLoss for solution a
// 6[a][3][0~4] is maxLoss for solution a

var o = "" //output of calculation

//Pts格式為 (圖鑑編號,寵物名,種族編號,體頂檔,力頂檔,強頂檔,速頂檔,魔頂檔,屬性,屬性量,卡色,卡等,技能欄,出沒地點,一級點,出現率[分鐘],可否封印)
//          (  Pts[0],   [1],     [2],   [3],   [4],   [5],   [6],   [7], [8],   [9],[10],[11],  [12],    [13],  [14],        [15],    [16])
//寵物名: 如標明(缺), 表示檔次資料不齊, 無法正確計算
//卡色: G=金, S=銀, N=普
//屬性: A=地水,B=水火,C=火風,D=風地  例:A9=地9水1, D10=風10
//卡色,卡等,出沒地點,一級點,出現率: X=不適用, ?=未知
//可否封印: Y/N
Pts = new Array(
  new Array(1,"虎人",0,22,26,17,19,16,"D",7,"N",2,8,"謎之迷宮11~16,里歐波多洞窟20~25,風之洞窟26~31,動物實驗室65,迷龍之巢29~31","動物實驗室(108,94)(118,97)",10,"Y"),
  new Array(2,"貓妖",0,19,24,17,28,17,"B",7,"N",2,9,"謎之迷宮11~16,水之洞窟54~61,動物實驗室65","動物實驗室(112,107)",10,"Y"),
  new Array(3,"羅剎",0,24,25,14,22,20,"B",3,"S",3,9,"詛咒的迷宮地下11~20樓41~43,炎之洞窟40~50","詛咒的迷宮地下13樓(25,5)",45,"Y"),
  new Array(4,"貓人",0,23,27,15,26,14,"D",5,"S",3,9,"風之洞窟26~31,迷龍之巢29~34,莎蓮娜東邊洞窟35~37","莎蓮娜東邊洞窟地下2樓(12,16)",90,"Y"),
  new Array(5,"惡魔貓",0,21,23,12,27,22,"D",3,"S",3,9,"阿巴尼斯洞窟34~36","阿巴尼斯洞窟傑村側1樓(15,15)",50,"Y"),
  new Array(6,"妖狐",0,18,30,11,25,26,"B",5,"S",4,8,"冰之洞窟57~59","冰之洞窟二樓(16,24)",120,"Y"),
  new Array(7,"穴熊",0,34,34,19,19,14,"A",8,"N",3,6,"維諾亞洞窟16~18","維諾亞洞窟全域",20,"Y"),
  new Array(8,"赤熊",0,35,36,15,20,14,"C",8,"N",5,6,"尼維爾海村周圍10~13","尼維爾海村附近 (515,469)(510,470)",70,"Y"),
  new Array(9,"北極熊",0,36,33,22,18,11,"A",2,"N",5,6,"阿巴尼斯村周圍31~33","阿巴尼斯村外(255,182)(256,191)",40,"Y"),
  new Array(10,"赤目黑熊",0,33,35,14,22,16,"C",2,"S",6,6,"參道33~35,伊姆爾森林68~70","X","X","Y"),
  new Array(11,"貓熊",0,32,40,18,17,18,"B",5,"G",7,7,"X","火焰鼠彩卷B獎","X","Y"),
  new Array(12,"大地鼠",0,6,13,20,26,35,"A",10,"N",1,10,"聖拉魯卡域4~6,流星山丘18~20,一勳遺跡75","聖拉魯卡村外(235,203)(149,219)",10,"Y"),
  new Array(13,"惡夢鼠",0,4,8,18,33,37,"B",10,"S",2,10,"青龍的洞窟23~25,王族的通道49,一勳遺跡75","五勳任務的王族用脫逃暗道 東方(30,40)","?","Y"),
  new Array(14,"火焰鼠",0,7,12,15,34,32,"C",10,"N",1,10,"奇利村周邊15~17,流星山丘18~20,尼維爾海域,炎之洞窟39~47,一勳遺跡75","奇利村外(230,330)(235,326)",15,"Y"),
  new Array(15,"寶石鼠",0,7,7,22,27,37,"D",10,"S",2,10,"鏡中豪宅21~24,一勳遺跡75","鏡中豪宅一樓(24,6)(24,8)",40,"Y"),
  new Array(16,"水藍鼠",0,11,15,28,28,33,"A",5,"G",6,10,"X","火焰鼠彩卷B獎","X","Y"),
  new Array(17,"鼠王",0,15,7,19,32,42,"C",5,"G",7,10,"X","鼠王驚奇蛋1等獎","X","Y"),
  new Array(18,"地獄看門犬",0,26,36,12,23,18,"B",6,"N",4,7,"奇怪的洞窟16~19,里歐波多洞窟20~25,魯米那斯附近45~46","亞留特村內(48,37),用Lv20以上地獄看門犬換","X","Y"),
  new Array(19,"巨狼",0,22,37,11,25,20,"A",6,"N",4,7,"峽之洞窟42~47","X","X","Y"),
  new Array(20,"地獄獵犬",0,24,35,19,22,15,"C",6,"S",5,7,"哥拉爾城周邊12~14,詛咒的迷宮地下1~10樓38~40,炎之洞窟40~50","詛咒的迷宮地下4樓(13,11)(16,11)",90,"Y"),
  new Array(21,"地獄妖犬",0,23,40,13,21,18,"D",6,"S",5,7,"積雪的山道39~45,貝茲雷姆神殿附近25~27,雷克塔爾村北側48~49","傑諾瓦近郊的貝茲雷姆迷宮附近(121,315)(118,323)",50,"Y"),
  new Array(22,"殭屍",1,37,32,12,12,12,"D",6,"N",2,9,"暗醫躲藏的家6~9,暖爐底13~15,奇怪洞窟16~19,暗醫洞窟17~23,阿魯巴斯洞窟20~23,翠格墓園23~24,黑暗之巢27~30","阿魯巴斯研究所最上層",5,"Y"),
  new Array(23,"喪屍",1,35,34,7,15,14,"B",6,"S",3,9,"積雪的山道39~45,黑暗之巢27~30","雪山山頂(21,16)",90,"Y"),
  new Array(24,"食屍鬼",1,32,32,17,7,17,"C",6,"N",2,9,"阿魯巴斯洞窟20~23,黑暗之巢27~30","阿魯巴斯研究所最上層",5,"Y"),
  new Array(25,"腐屍",1,42,37,12,7,7,"A",6,"N",2,9,"黑暗醫生躲藏的家10,奇怪的洞窟16~19,黑暗醫生洞窟18~23,阿魯巴斯洞窟20~23,黑暗之巢27~30","阿魯巴斯研究所最上層",5,"Y"),
  new Array(26,"木乃伊",1,39,32,14,8,17,"C",5,"S",4,8,"沙漠之祠25~31,黑暗之巢28~30,伊姆爾森林68~73","沙漠祠堂第7層(13,25)",30,"Y"),
  new Array(27,"骷髏戰士",1,12,27,42,12,17,"D",7,"N",3,8,"翠格墓園20~24,青龍的洞窟23~25,羅連斯研究塔22~24","X","X","Y"),
  new Array(28,"血骷髏",1,13,24,41,10,22,"C",7,"S",4,8,"夜之蒂娜村31~33","夜之蒂娜村外的海賊海灣(16,32)",110,"Y"),
  new Array(29,"地獄骷髏",1,14,30,40,11,15,"B",7,"N",3,8,"沙塵洞窟24~29","X","X","Y"),
  new Array(30,"武裝骷髏",1,9,26,47,8,20,"A",7,"S",4,8,"南恰拉山第2通道21~23,齋戒男路線36~38","齋戒男路線第2層(63,5)",100,"Y"),
  new Array(31,"骷髏海盜",1,12,29,45,13,16,"A",5,"N",3,8,"伊姆爾森林68~73","X","X","Y"),
  new Array(32,"幽靈",1,19,18,31,20,27,"A",2,"N",3,7,"地下迷宮9~16,暖爐之底13~15,,翠格墓園21~24,詛咒的迷宮地下41~50樓50~52","詛咒的迷宮地下41樓(7,6)(7,8)(8,5)",50,"Y"),
  new Array(33,"鬼靈",1,9,21,27,25,33,"C",8,"S",5,7,"黑色祈禱19~20,南恰拉山第1通道18~22,峽之洞窟42~47","峽之洞窟(74,4)(74,5)需打贏地縛靈","?","Y"),
  new Array(34,"亡靈",1,14,27,30,15,29,"C",2,"S",5,7,"齋戒女路線36~38","齋戒女路線第2層(74,88)",100,"Y"),
  new Array(35,"死靈",1,10,28,32,17,28,"A",8,"N",4,7,"夜之蒂娜村31~33","夜之蒂娜村(64,53)(33,26)(20,64)(53,48)",300,"Y"),
  new Array(36,"小石像怪",2,16,21,11,31,26,"A",5,"N",1,9,"靈堂1~2,米諾基亞村周邊46~47","靈堂全域",5,"Y"),
  new Array(37,"使魔",2,21,20,15,27,27,"C",7,"N",2,9,"X","完成國民任務後隨機取得","X","Y"),
  new Array(38,"水藍鳥魔",2,22,23,10,25,25,"A",3,"S",3,9,"鏡中豪宅21~24,哥拉爾城周邊11~13,水之洞窟54~61","鏡中豪宅2樓(40,25)",60,"Y"),
  new Array(39,"小惡魔",2,21,20,9,25,30,"D",3,"N",2,9,"亞諾曼城周邊5~10,土之洞窟12~16,奇利村周邊15~17,羽音洞窟30~34","奇利村附近(280,400)",30,"Y"),
  new Array(40,"迷你石像怪",2,23,19,10,24,29,"C",3,"S",3,9,"阿凱魯法外11~13,風之洞窟26~31,詔三47~49,迷龍之巢29~34","詛咒的迷宮地下35樓(18,5)(18,8)",60,"Y"),
  new Array(41,"丘比特",2,12,22,7,37,37,"C",5,"G",7,9,"X","火焰鼠彩卷B獎","X","Y"),
  new Array(42,"石像怪",2,14,30,32,22,22,"D",1,"S",6,6,"黑白龍城67~70,祭壇2~60","X","X","Y"),
  new Array(43,"血魔",2,13,31,26,25,25,"B",1,"N",6,6,"黑白龍城67~70,祭壇2~60","X","X","Y"),
  new Array(44,"墮天使",2,11,28,28,27,26,"A",1,"S",6,6,"冰雪的牢城60~62,黑白龍城67~70,祭壇2~60","X","X","Y"),
  new Array(45,"惡魔",2,10,27,26,26,31,"C",1,"N",5,6,"冰雪的牢城60~62,黑白龍城67~70,祭壇2~60","X","X","Y"),
  new Array(46,"小蝙蝠",2,11,26,16,31,21,"A",6,"N",2,10,"亞諾曼城周邊8~10","完成國民任務後隨機取得","X","Y"),
  new Array(47,"掃把蝙蝠",2,13,28,12,29,18,"B",6,"S",2,10,"莎蓮娜東邊洞窟35~37","莎蓮娜東邊洞窟第二個地下二樓(18,25)",60,"Y"),
  new Array(48,"迷你蝙蝠",2,11,26,20,27,16,"C",6,"N",1,10,"法蘭城周邊1~5,競技場迷宮7~9,聖拉魯卡域3~5,炎之洞窟39~47,法蘭城門外1~2","法蘭周邊,炎之洞窟外",5,"Y"),
  new Array(49,"水果蝙蝠",2,17,25,15,26,17,"D",6,"S",2,10,"霞之洞窟3~14,里歐波多洞窟20~25,魯米那斯附近45~46","X","X","Y"),
  new Array(50,"惡魔蝙蝠",2,13,34,10,29,24,"B",8,"G",7,10,"X","黑龍城任務報酬","X","Y"),
  new Array(51,"天使蝙蝠",2,9,22,12,37,30,"D",8,"G",7,10,"X","白龍城任務報酬","X","Y"),
  new Array(52,"大蝙蝠",2,23,28,23,28,13,"A",7,"N",2,7,"試煉洞窟1~4,黑暗醫生躲藏的家6~9,競技場迷宮7~9,黑暗醫生洞窟18~21,峽之洞窟46~50","試煉洞窟1,2樓全域",5,"Y"),
  new Array(53,"巨蝙蝠",2,27,30,22,24,12,"C",3,"N",3,7,"佈滿青苔的洞窟17~19,青龍的洞窟26~27","青龍的洞窟第4層(71,68)(72,66)",60,"Y"),
  new Array(54,"海蝙蝠",2,18,29,27,30,11,"A",3,"N",4,7,"海賊的洞窟13~15,地底湖17~19,雷克塔爾村南側48,羽音洞窟30~34","地底湖地下2樓(42,60)(40,61)(44,60)(45,60)",30,"Y"),
  new Array(55,"胖蝙蝠",2,25,24,20,26,20,"C",7,"S",5,7,"阿巴尼斯洞窟34~36","莎蓮娜西方洞窟阿村側1樓(30,46)(29,44)",60,"Y"),
  new Array(56,"兔耳蝙蝠",2,21,26,18,31,14,"B",5,"S",4,8,"蒂娜村周邊29~31","蒂娜村附近(481,255)",240,"Y"),
  new Array(57,"藍蠍",3,20,27,47,13,8,"B",9,"S",5,7,"索奇亞沙漠21~22","加納沙漠(582,327)",60,"Y"),
  new Array(58,"紅蠍",3,19,28,42,19,7,"C",9,"N",4,7,"鯰魚洞窟23~25","鯰魚洞窟地下第3層(26,17)(32,17)",50,"Y"),
  new Array(59,"黃蠍",3,20,30,43,12,10,"D",9,"S",5,7,"索奇亞沙漠20~22","加納沙漠(525,348)(544,341)(539,346)",150,"Y"),
  new Array(60,"殺手蠍",3,30,29,38,11,7,"A",9,"N",4,7,"沙漠之祠25~31","沙漠之祠第8層(17,11)(16,7)<a href='http://ajet.nsysu.edu.tw/~ks176/poor.jpg' target='_blank'><font color='#FFFFFF'>蒔</font></a>",60,"Y"),
  new Array(61,"殺人蜂",3,12,37,12,37,12,"D",5,"S",4,8,"米內葛爾島中部36~38","米內葛爾島中部(447,356)需通過路霸",60,"Y"),
  new Array(62,"異型蜂",3,14,33,11,35,17,"C",5,"N",3,8,"維諾亞村周邊11~13,烏克蘭入口14~16,坎那貝拉村外42~44","維諾亞村周邊(428,400)(405,380)(470,378)(514,382)",20,"Y"),
  new Array(63,"虎頭蜂",3,13,40,8,38,11,"D",3,"S",4,8,"烏克蘭入口14~16,雷姆爾山新道28~32,羽音洞窟30~34","X","X","Y"),
  new Array(64,"黃蜂",3,10,38,13,43,6,"C",7,"N",2,8,"伊爾村周邊6~8,風之洞窟30","伊爾村附近(668,310)(672,284)(690,286)(666,223)",15,"Y"),
  new Array(65,"死亡蜂",3,7,39,15,41,8,"B",7,"S",4,8,"亞諾曼城周邊5~10,蒂娜村周邊26~28","蒂娜村附近(284,372)(292,366)傑村後門過橋左轉",120,"Y"),
  new Array(66,"螳螂",3,16,44,22,27,11,"D",4,"N",5,6,"奇利村周邊16~18","奇利村附近(292,214)",15,"Y"),
  new Array(67,"殺人螳螂",3,12,45,20,26,17,"B",4,"N",6,6,"亞諾曼城周邊5~8,布朗山30~71","亞諾曼城東北方(297,244)",120,"Y"),
  new Array(68,"赤目螳螂",3,14,44,19,29,14,"C",4,"S",6,6,"亞諾曼城周邊5~12,風洞21~23,米諾基亞村周邊46~48,艾爾卡絲之家60","洪恩大風穴(131,29)(126,28)近加納出口樓梯",30,"Y"),
  new Array(69,"死灰螳螂",3,15,40,17,33,15,"B",5,"S",6,6,"蒂娜村周邊28~29","蒂娜村附近(454,328)(457,329)",110,"Y"),
  new Array(70,"致命螳螂",3,20,43,18,27,12,"A",4,"N",5,6,"井底道路18~20","通往烏克蘭村的井底道路2樓(44,4)",60,"Y"),
  new Array(71,"土蜘蛛",3,26,15,18,23,23,"A",10,"N",2,9,"牛鬼的洞窟9~14,海賊指揮部6~10,聖村倉庫10~12,流星山丘18~20","牛鬼討伐任務, 對戰鬼犬時會出現","X","Y"),
  new Array(72,"水蜘蛛",3,24,16,17,20,28,"B",10,"S",3,9,"風洞21~23","洪恩大風穴(9,31)(10,33)",30,"Y"),
  new Array(73,"火蜘蛛",3,22,22,16,25,20,"C",10,"N",2,9,"試煉洞窟1~4,哈洞7~9,聖村倉庫10~12,流星山丘18~20","試煉洞窟5樓(22,14)",10,"Y"),
  new Array(74,"風蜘蛛",3,25,28,15,19,18,"D",10,"S",3,9,"迷路之穴5~9,沙塵洞窟24~29,風之洞窟30","X","X","Y"),
  new Array(75,"樹精",4,32,17,32,12,17,"B",4,"N",2,8,"伊爾村周邊6~8,戴克斯特山脈5~15,坎那貝拉村外42~44","伊爾村附近(561,211)(563,200)(568,196)",15,"Y"),
  new Array(76,"死亡樹精",4,28,20,37,9,16,"A",6,"S",4,8,"蒂娜村周邊27~29","蒂娜村附近(361,339)",90,"Y"),
  new Array(77,"黃金樹精",4,38,22,28,10,17,"D",6,"G",7,8,"X","黃金樹精任務報酬","X","Y"),
  new Array(78,"慘白樹精",4,29,16,28,17,20,"C",3,"S",4,8,"戴克斯特山脈6~15,蒂娜村周邊26~30","蒂娜村附近(570,240)(559,246)",60,"Y"),
  new Array(79,"冰冷樹精",4,30,15,27,16,22,"B",7,"N",3,8,"亞留特村周邊10~13,奴克冰原12~15","亞留特村附近(579,44)(685,156)",10,"Y"),
  new Array(80,"沼澤樹精",4,31,14,29,15,21,"A",7,"S",4,8,"阿凱魯法村附近12~14","米內葛爾島(171,385)",50,"Y"),
  new Array(81,"妖草",4,26,11,16,16,36,"A",8,"N",2,9,"維諾亞村周邊11~13,土之洞窟12~16,米內葛爾島中部36~38","維諾亞村周邊(422,357)(471,395)(490,392)",25,"Y"),
  new Array(82,"蔓陀羅草",4,25,13,14,15,38,"D",5,"S",3,9,"傑諾瓦村周邊23~25,布朗山30~71","傑諾瓦村附近(280,488)(281,489)",45,"Y"),
  new Array(83,"妖花",4,27,12,12,19,35,"C",5,"S",3,9,"X","再生花園任務報酬","X","Y"),
  new Array(84,"人魔草",4,22,17,11,14,41,"B",8,"S",3,9,"參道33~35","X","X","Y"),
  new Array(85,"綠色口臭鬼",4,38,23,16,15,23,"D",1,"N",4,7,"莎蓮娜海底24~26,米內葛爾島中部35~37","莎蓮娜海底1樓芙蕾雅側(9,12)(10,10)(10,13)",60,"Y"),
  new Array(86,"黃色口臭鬼",4,37,27,18,11,22,"D",9,"N",4,7,"維諾亞村周邊11~14,阿凱魯法村附近12~14","維諾亞村周邊(346,514)(371,446)(394,512)(416,564)",20,"Y"),
  new Array(87,"藍色口臭鬼",4,35,25,15,18,27,"B",9,"S",5,7,"鯰魚內25~27,亞諾曼城周邊5~8,米內葛爾島中部36~38","鯰魚洞窟胃袋(53,43)鯰魚大王胃袋(59,41)",60,"Y"),
  new Array(88,"紅色口臭鬼",4,44,21,14,12,29,"B",1,"N",4,7,"尼維爾村周邊(??),大樹66~67","尼維爾海村以西(460,350)",25,"Y"),
  new Array(89,"兇暴仙人掌",4,27,29,22,12,20,"D",5,"N",3,8,"詛咒的迷宮地下41~50樓50~52","詛咒的迷宮地下41樓(10,20)",60,"Y"),
  new Array(90,"武術仙人掌",4,24,32,27,10,17,"A",5,"S",4,8,"索奇亞沙漠19~21","加納沙漠(546,407)(561,401)",60,"Y"),
  new Array(91,"兔耳仙人掌",4,28,35,19,14,14,"C",5,"S",4,8,"索奇亞沙漠19~21","加納沙漠(627,302)(634,296)",40,"Y"),
  new Array(92,"印地安仙人掌",4,26,36,24,9,15,"B",5,"N",3,8,"奇利村周邊16~18","奇利村附近(306,329)(341,316)(343,312)(345,314)",60,"Y"),
  new Array(93,"火焰舞者",4,19,38,18,15,25,"B",2,"G",5,8,"X","鯰魚大王任務報酬","X","Y"),
  new Array(94,"史萊姆",5,46,26,11,6,16,"D",1,"N",1,9,"哈洞7~9,暖爐之底13~15,佈滿青苔的洞窟17~20,科學家的牢房19~21,忍者之家16~18","法蘭城龜裂的地下道全域",5,"Y"),
  new Array(95,"液態史萊姆",5,49,24,15,5,12,"A",1,"N",2,9,"迷路之穴5~9,科學家的牢房19~21","法蘭城龜裂的地下道地圖上的NPC","X","Y"),
  new Array(96,"果凍史萊姆",5,45,31,6,10,13,"B",1,"S",3,9,"科學家的牢房19~21,忍者之家16~18,莎蓮娜海底24~26,奇怪的坑道26~30,炎之洞窟39~47","莎蓮娜海底通道一樓傑村側(7,8)",40,"Y"),
  new Array(97,"布丁史萊姆",5,40,25,12,8,20,"C",1,"S",3,9,"科學家的牢房19~21,鯰魚內25~27,王族的通道49","鯰魚大王胃袋(第一層)(97,84)",45,"Y"),
  new Array(98,"火精",5,25,25,25,25,25,"C",10,"G",6,9,"X","火焰鼠彩卷A獎","X","Y"),
  new Array(99,"風精",5,25,25,25,25,25,"D",10,"G",6,9,"X","火焰鼠彩卷A獎","X","Y"),
  new Array(100,"水精",5,25,25,25,25,25,"B",10,"G",6,9,"X","火焰鼠彩卷A獎","X","Y"),
  new Array(101,"地精",5,25,25,25,25,25,"A",10,"G",6,9,"X","火焰鼠彩卷A獎","X","Y"),
  new Array(102,"頑皮炸彈",5,15,15,15,15,40,"A",8,"N",1,10,"土之洞窟12~16,南恰拉山第1通道18~22","南恰拉山第1通道1樓(29,5)(30,7)(33,5)(35,5)",60,"Y"),
  new Array(103,"寶貝炸彈",5,14,17,11,16,42,"B",8,"S",2,10,"霞之洞窟3~14,里歐波多洞窟20~25,詛咒的迷宮地下31~40樓","詛咒的迷宮地下36樓(22,5)",60,"Y"),
  new Array(104,"大炸彈",5,12,20,14,14,40,"C",8,"S",2,10,"貝茲雷姆迷宮34~36,魯米那斯附近47~48","X","X","Y"),
  new Array(105,"漂浮炸彈",5,16,14,14,17,39,"D",8,"N",1,10,"競技場迷宮7~9,地下迷宮9~16,風之洞窟26~31,迷龍之巢29~34","法蘭城內競技場迷宮第一地圖(53,43)(已關閉)","X","Y"),
  new Array(106,"丸子炸彈",5,17,17,7,17,47,"D",5,"G",6,10,"X","火焰鼠彩卷B獎","X","Y"),
  new Array(107,"幻影",5,20,26,25,17,32,"C",10,"N",6,6,"佛利波羅島56~58,冰雪的牢城56~57,阿卡斯島56~58,風鳴之塔56~57,六曜之塔56~57","X","X","N"),
  new Array(108,"旋律影子",5,24,28,22,19,27,"B",10,"N",6,6,"佛利波羅島56~58,冰雪的牢城56~57,阿卡斯島56~58,風鳴之塔56~57,六曜之塔56~58","X","X","N"),
  new Array(109,"闇影",5,25,23,23,23,26,"D",10,"N",6,6,"佛利波羅島56~58,冰雪的牢城56~57,阿卡斯島56~58,風鳴之塔56~57,六曜之塔56~59","X","X","N"),
  new Array(110,"陰影",5,28,24,22,22,24,"A",10,"N",6,6,"佛利波羅島56~58,冰雪的牢城56~57,阿卡斯島56~58,風鳴之塔56~57,六曜之塔56~60","X","X","N"),
  new Array(111,"血腥之刃",6,9,39,34,14,24,"A",9,"S",6,6,"黑色祈禱19~20,詛咒的迷宮地下11~20樓41~43","詛咒的迷宮地下18樓(22,12)",90,"Y"),
  new Array(112,"殺龍之刃",6,17,37,41,11,19,"B",9,"N",5,6,"六曜之塔63~65","X","X","Y"),
  new Array(113,"火焰之刃",6,10,39,28,12,31,"C",9,"N",5,6,"齋戒男路線36~38","齋戒男路線第3層(17,16)(18,19)",150,"Y"),
  new Array(114,"烈風之刃",6,12,44,29,13,27,"D",9,"S",6,6,"六曜之塔63~65","X","X","Y"),
  new Array(115,"嚇人箱",6,11,26,26,11,31,"C",2,"N",2,9,"寶箱中隨機出現","X","X","Y"),
  new Array(116,"兔耳嚇人箱",6,9,24,23,16,33,"B",2,"N",2,9,"寶箱中隨機出現","X","X","Y"),
  new Array(117,"紅魔嚇人箱",6,12,32,27,12,27,"B",5,"N",3,8,"寶箱中隨機出現","X","X","Y"),
  new Array(118,"藍魔嚇人箱",6,15,37,28,8,22,"A",2,"N",3,8,"寶箱中隨機出現","X","X","Y"),
  new Array(119,"綠蛙嚇人箱",6,13,35,29,10,23,"D",2,"N",3,8,"寶箱中隨機出現","X","X","Y"),
  new Array(120,"純白嚇人箱",6,9,24,29,11,37,"D",5,"S",7,9,"寶箱中隨機出現","X","X","Y"),
  new Array(121,"冰怪",6,20,30,46,7,12,"B",10,"N",4,7,"齋戒女路線36~38","齋戒女路線第3層(134,85)(131,79)",120,"Y"),
  new Array(122,"石怪",6,15,38,43,6,13,"A",10,"N",4,7,"X","月亮俱樂部任務報酬(28天)","X","Y"),
  new Array(123,"銀怪",6,10,32,48,8,17,"C",10,"N",4,7,"X","用三箱古錢交換(2970個古錢)","X","Y"),
  new Array(124,"金怪",6,14,41,40,5,15,"D",10,"N",4,7,"X","用十箱古錢交換(9990個古錢)","X","Y"),
  new Array(125,"惡魔螃蟹",6,16,32,35,11,11,"B",2,"N",2,9,"維諾亞洞窟16~18,誓約的海道32~34","維諾亞洞窟1樓(42,66)",25,"Y"),
  new Array(126,"水晶螃蟹",6,18,31,36,10,10,"B",8,"N",2,9,"蒂娜村周邊29~31,水之洞窟54~61","蒂娜村附近(517,238)",120,"Y"),
  new Array(127,"鐵剪螃蟹",6,14,34,37,12,8,"D",2,"S",3,9,"加納村周邊17~19,誓約的海道32~34,貝尼恰斯火山71~75","加納村周邊(501,209)(462,205)",100,"Y"),
  new Array(128,"黃金螃蟹",6,22,30,34,7,12,"D",8,"S",3,9,"井底道路19~20,米內葛爾島中部37~39","井底道路2樓(22,29)",80,"Y"),
  new Array(129,"蜥蜴戰士",7,22,32,32,12,12,"D",3,"N",3,8,"索奇亞海底18~20,維諾亞海底26~27,永久凍土54~63,咨詢60~64","海底2層(8,47)",60,"Y"),
  new Array(130,"蜥蜴鬥士",7,18,37,37,8,10,"A",3,"S",4,8,"羅連斯研究塔21~23,詔二44~46,深淵54~63,咨詢60~64","詛咒的迷宮地下22樓(17,10)",60,"Y"),
  new Array(131,"蜥蝪武士",7,20,31,30,15,14,"B",3,"N",3,8,"永久凍土54~63,咨詢60~64","X","X","Y"),
  new Array(132,"獵豹蜥蜴",7,23,36,28,10,13,"C",3,"S",4,8,"南恰拉山口13~15,詔二44~46,深淵54~63,咨詢60~64","詛咒的迷宮地下29樓(12,12)",60,"Y"),
  new Array(133,"大地翼龍",7,29,28,32,20,11,"A",10,"S",6,6,"貝茲雷姆迷宮34~36,詛咒的迷宮地下1~10樓38~40,咨詢60~64","詛咒的迷宮地下7樓(16,20)",100,"Y"),
  new Array(134,"寒冰翼龍",7,30,30,31,17,12,"B",10,"N",5,6,"青龍的洞窟26~28","青龍的洞窟第4層(11,23)",50,"Y"),
  new Array(135,"火焰翼龍",7,33,33,25,16,13,"C",10,"N",5,6,"X","X","X","Y"),
  new Array(136,"烈風翼龍",7,32,30,23,20,15,"D",10,"S",5,6,"X","X","X","Y"),
  new Array(137,"翼龍",7,32,30,26,19,18,"B",5,"G","?",6,"X","X","X","Y"),
  new Array(138,"地龍蜥",7,29,34,34,15,8,"A",8,"N",4,7,"鯰魚洞窟23~25,深淵54~63,咨詢60~64","鯰魚洞窟第3層(20,37)",60,"Y"),
  new Array(139,"水龍蜥",7,36,38,34,11,6,"B",8,"N",4,7,"索奇亞海底18~20,維諾亞海底26~27,永久凍土54~63,咨詢60~64","維諾亞海底洞窟第2層(49,8)",35,"Y"),
  new Array(140,"火龍蜥",7,32,37,37,12,7,"C",8,"S",5,7,"峽之洞窟46~50,深淵54~63,咨詢60~64","酒之殿堂外(765,48 )",150,"Y"),
  new Array(141,"風龍蜥",7,35,35,31,10,9,"D",8,"S",5,7,"地底湖17~19,永久凍土54~63,咨詢60~64","傑諾瓦村附近(145,522)",60,"Y"),
  new Array(142,"哥布林",8,27,27,27,17,7,"A",7,"N",1,9,"法蘭城周邊1~5,哥布林之家3~12,牛鬼的洞窟9~13,里歐波多洞窟20~25","法蘭城門外,牛鬼討伐任務對戰鬼犬時",5,"Y"),
  new Array(143,"紅帽哥布林",8,23,30,29,20,5,"B",7,"N",2,9,"法蘭城周邊3~4,哥布林之家3~12,哥拉爾城周邊11~13,維諾亞村周邊11~14,里歐波多洞窟20~25","維諾亞村周邊,牛鬼任務","X","Y"),
  new Array(144,"火焰哥布林",8,22,28,26,15,14,"C",7,"S",3,9,"牛鬼的洞窟9~13,傑諾瓦村周邊23~25,魯米那斯附近45~46","傑諾瓦村附近(257,593)",60,"Y"),
  new Array(145,"烈風哥布林",8,30,26,24,23,4,"D",7,"S",3,9,"奇怪的坑道26~30","深淵地下水脈(44,56) ","X","Y"),
  new Array(146,"巨人",8,38,35,24,9,14,"A",10,"N",5,6,"風鳴之塔60~62","風鳴之塔10樓(14,62)(15,62)",50,"Y"),
  new Array(147,"單眼巨人",8,34,34,20,12,20,"B",10,"S",6,6,"X","X","X","Y"),
  new Array(148,"泰坦巨人",8,39,30,28,8,15,"D",10,"S",6,6,"紳士淑女養成學校","紳士淑女養成學校(11)","X","Y"),
  new Array(149,"亞特拉斯巨神",8,37,37,17,17,12,"C",10,"S",6,6,"風鳴之塔60~62","風鳴之塔10樓(60,65)",50,"Y"),
  new Array(150,"盜賊",8,23,28,21,31,12,"C",5,"N",3,7,"伊爾外1~9,聖拉魯卡域3~5,牛鬼的洞窟9~14,海賊的洞窟11~14,維諾亞周邊10~15,加納周邊18~21,奇利周邊17~19","伊爾村近郊","X","N"),
  new Array(151,"山賊",8,28,27,24,26,10,"D",5,"N",4,7,"加納12~20,奇利17~19,奴克冰原14~22,地下遺跡45~49","X","X","N"),
  new Array(152,"海盜",8,19,31,23,28,14,"B",5,"N",4,7,"海賊的洞窟11~14,加納村周邊18~20","X","X","N"),
  new Array(153,"破壞狂",8,27,26,30,24,8,"A",5,"N",4,7,"奇怪的坑道26~31","X","X","N"),
  new Array(154,"鳥人",8,17,17,17,37,22,"D",1,"N",3,8,"亞留特村周邊10~13,大樹66~67","亞留特村附近(620,65)",10,"Y"),
  new Array(155,"幻歌妖",8,15,18,20,38,19,"A",1,"S",4,8,"貝茲雷姆神殿附近25~27","貝茲雷姆迷宮附近(80,346)",60,"Y"),
  new Array(156,"狠毒鳥人",8,18,19,14,39,20,"B",1,"N",3,8,"亞諾曼城周邊5~8,加納村周邊17~19","加納村周邊(473,387)",60,"Y"),
  new Array(157,"烈風鳥人",8,13,20,12,42,23,"C",1,"S",4,8,"阿巴尼斯村周邊31~33","阿巴尼斯村附近(56,163)",120,"Y"),
  new Array(158,"黑暗鳥人",8,19,11,11,43,31,"D",5,"S",4,8,"冰之洞窟57~59","冰之洞窟2樓(65,39)",120,"Y"),
  new Array(159,"山飛甲",0,27,21,15,30,27,"D",4,"N","?",6,"X","X","X","Y"),
  new Array(160,"獨角獸",0,17,25,13,28,37,"A",4,"S","?",6,"X","一等勳艾國獎品","X","Y"),
  new Array(161,"天馬",0,22,22,12,32,32,"B",4,"N","?",6,"X","一等勳艾國獎品","X","Y"),
  new Array(162,"麒麟",0,19,27,10,34,30,"C",4,"S","?",6,"X","X","X","Y"),
  new Array(163,"地底龜",0,22,22,37,10,19,"D",5,"N","?",8,"X","X","X","Y"),
  new Array(164,"海底龜",0,23,20,45,4,18,"A",5,"S",4,8,"坎那貝拉村外42~45","庫魯克斯島坎那貝拉村西(447,320)",50,"Y"),
  new Array(165,"火焰龜",0,27,17,42,7,17,"B",5,"N",3,8,"米內葛爾島中部35~37","米內葛爾島中部(378,268)",60,"Y"),
  new Array(166,"硬殼龜",0,26,16,47,5,16,"C",5,"S",4,8,"無人的洞窟","X","X","Y"),
  new Array(167,"鐮刀魔",1,23,35,18,17,32,"A",10,"N","?",6,"X","一等勳蘭國獎品","X","N"),
  new Array(168,"暗黑僧侶",1,17,37,22,12,37,"B",10,"S",7,6,"X","X","X","N"),
  new Array(169,"斬首者",1,19,42,20,15,29,"C",10,"S","?",6,"X","一等勳蘭國獎品","X","N"),
  new Array(170,"冥界死神",1,25,40,12,21,27,"D",10,"N","?",6,"X","X","X","N"),
  new Array(171,"牙骨",1,27,32,32,12,7,"D",1,"N","?",8,"X","X","X","Y"),
  new Array(172,"顎牙",1,32,29,37,7,5,"A",1,"S",4,8,"伊姆爾森林68~70","X","X","Y"),
  new Array(173,"巨牙",1,25,30,27,17,11,"B",1,"N",3,8,"南恰拉山第2通道21~23","南恰拉山第2通道1樓(9,23)",90,"Y"),
  new Array(174,"利牙",1,30,37,30,9,4,"C",1,"S","?",8,"X","X","X","Y"),
  new Array(175,"獅鷲獸",2,22,32,12,42,17,"D",4,"N","?",6,"X","狩獵任務得到的蛋孵化出","X","Y"),
  new Array(176,"變種獅鷲獸",2,26,29,15,39,16,"A",4,"N","?",6,"X","X","X","Y"),
  new Array(177,"布雷歐",2,20,34,9,47,15,"B",4,"S","?",6,"X","X","X","Y"),
  new Array(178,"依格羅斯",2,18,36,11,44,16,"C",4,"S","?",6,"X","X","X","Y"),
  new Array(179,"托羅帝鳥",2,32,20,13,35,10,"D",2,"N",3,8,"X","X","X","Y"),
  new Array(180,"岩地跑者",2,27,22,17,32,12,"A",2,"S",4,8,"米內葛爾島中部37~39","米內葛爾島中部(433,133) / 狩獵任務得到的蛋",90,"Y"),
  new Array(181,"火焰啄木鳥",2,22,27,19,29,13,"B",2,"N",3,8,"雷姆爾山新道28~32","X","X","Y"),
  new Array(182,"狂奔鳥",2,25,24,18,36,7,"C",2,"S","?",8,"X","X","X","Y"),
  new Array(183,"甲蟲",3,17,37,32,12,17,"A",8,"N",4,7,"南恰拉山口13~15","南恰拉山口(312,403)",50,"Y"),
  new Array(184,"掘地蟲",3,20,35,36,8,16,"B",8,"S",5,7,"坎那貝拉村南部森林","庫魯克斯島坎那貝拉村南(551,420)",25,"Y"),
  new Array(185,"鍬型蟲",3,15,39,29,14,18,"C",8,"N",5,7,"麥尼的洞窟70~71","麥尼的洞窟?","X","Y"),
  new Array(186,"獨角仙",3,18,41,34,9,14,"D",8,"S",5,7,"坎那貝拉村南部森林","米內葛爾島中部小島(514,353)  ","?","Y"),
  new Array(187,"翠綠菇",4,37,12,12,17,37,"D",4,"S",5,7,"坎那貝拉村外42~44","庫魯克斯島坎那貝拉村西(458,299)",30,"Y"),
  new Array(188,"水藍菇",4,38,15,13,15,34,"A",4,"N",4,7,"阿凱魯法村附近11~13","米內葛爾島(241,268)",80,"Y"),
  new Array(189,"粉紅菇",4,35,10,15,14,41,"B",4,"N",4,7,"地下遺跡45~49","小梅之間(10,17)",90,"Y"),
  new Array(190,"星菇",4,40,13,10,13,39,"C",4,"S",5,7,"米內葛爾島中部36~38","米內葛爾島中部(311,79)",100,"Y"),
  new Array(191,"綠煙",5,20,20,14,25,36,"D",3,"N","?",7,"X","X","X","Y"),
  new Array(192,"煙霧",5,23,23,8,30,31,"A",3,"N",4,7,"米諾基亞村周邊46~48,艾爾卡絲之家60","米諾基亞村附近(616,834)",20,"Y"),
  new Array(193,"煙羅",5,22,22,12,27,32,"B",3,"S",5,7,"貝尼恰斯火山71~75","貝尼恰斯火山地下9樓(30,56)",40,"Y"),
  new Array(194,"棉球",5,25,26,9,25,30,"C",3,"S","?",7,"X","盲目之龍艾汀任務獎品 ","X","Y"),
  new Array(195,"盾",6,15,15,45,15,30,"D",4,"S","?",6,"X","X","X","Y"),
  new Array(196,"潛盾",6,17,12,47,12,32,"A",4,"N",5,6,"哥拉爾城周邊12~14","庫魯克斯島哥拉爾城附近(153,405)",40,"Y"),
  new Array(197,"強盾",6,19,13,49,11,28,"B",4,"N",5,6,"魯米那斯附近45~46","庫魯克斯島魯米那斯附近(364,606)",30,"Y"),
  new Array(198,"神盾",6,16,9,50,8,37,"C",4,"S",6,6,"雷克塔爾村南側48","庫魯克斯島(731,672)",10,"Y"),
  new Array(199,"岩怪",6,29,22,40,5,14,"A",7,"S",4,8,"魯米那斯附近47~48,貝尼恰斯火山71~75","庫魯克斯島貝尼恰斯火山域(500,632)",20,"Y"),
  new Array(200,"爆岩",6,30,20,42,6,12,"B",7,"N",3,8,"伊利斯礦山","伊利斯礦山大坑道(105,34)",30,"Y"),
  new Array(201,"熔岩",6,32,17,37,7,17,"C",7,"S",4,8,"貝尼恰斯火山71~75","貝尼恰斯火山2樓(59,44)",60,"Y"),
  new Array(202,"影岩",6,31,15,32,12,20,"D",7,"N",3,8,"諾斯菲拉特59","X","X","Y"),
  new Array(203,"希特拉",7,42,42,27,7,7,"A",6,"N","?",6,"詛咒者的洞窟(地)76","X","X","Y"),
  new Array(204,"蛟龍",7,40,44,25,8,8,"B",6,"S","?",6,"詛咒者的洞窟(水)76","X","X","Y"),
  new Array(205,"埃及眼鏡蛇",7,38,45,30,6,6,"C",6,"N","?",6,"詛咒者的洞窟(火)76","X","X","Y"),
  new Array(206,"八岐大蛇",7,46,46,23,5,5,"D",6,"S","?",6,"X","X","X","Y"),
  new Array(207,"口袋龍",7,15,34,21,20,25,"D",5,"N",4,7,"魯米那斯附近45~46","庫魯克斯島魯米那斯附近(292,819)",30,"Y"),
  new Array(208,"迷你龍",7,10,35,23,21,26,"A",5,"S","?",7,"X","虛弱雛鳥任務的報酬","X","Y"),
  new Array(209,"雛龍",7,12,32,22,22,27,"B",5,"S","?",7,"X","X","X","Y"),
  new Array(210,"穴龍",7,11,31,20,25,28,"C",5,"N",4,7,"哥拉爾城周邊12~14","庫魯克斯島哥拉爾城北(402,345)",60,"Y"),
  new Array(211,"大型半獸人",8,34,25,35,10,11,"A",6,"N",4,7,"魯米那斯附近45~47","庫魯克斯島魯米那斯附近(460,629)",30,"Y"),
  new Array(212,"豬鬼",8,33,28,33,11,10,"B",6,"S",5,7,"雷克塔爾村北側48~49","雷克塔爾村以西(383,265)",20,"Y"),
  new Array(213,"鋼鬼",8,30,30,30,16,9,"C",6,"S",5,7,"米諾基亞村周邊46~47","米諾基亞村東門外(549,838)",20,"Y"),
  new Array(214,"半獸人",8,32,27,32,12,12,"D",6,"N",4,7,"哥拉爾城周邊11~13","庫魯克斯島哥拉爾城周邊(425,453)",60,"Y"),
  new Array(215,"陸行鯊(缺)",2,29,15,36,14,9,"A",3,"N",2,8,"法蘭城遺跡2~4,溫迪爾平原2~4","法蘭城遺跡全域","X","Y"),
  new Array(216,"沙地鯊(缺)",2,23,13,28,23,8,"B",10,"N","?",10,"X","X","X","N"),
  new Array(217,"丘陵鯊(缺)",2,18,8,18,33,4,"B",10,"N","?",10,"溫迪爾平原5~9","X","X","N"),
  new Array(218,"岩石鯊(缺)",2,27,35,7,8,25,"B",10,"N",3,10,"布拉基姆高地30~34","布拉基姆高地(148,138)附近(瀑布前方)","?","Y"),
  new Array(219,"雛鳥",2,7,8,5,38,39,"D",10,"G",9,10,"X","X","X","Y"),
  new Array(220,"鴨嘴獸(缺)",2,10,23,6,23,28,"B",10,"G",9,10,"溫迪爾平原5~9","X","X","Y"),
  new Array(221,"小鴨子(缺)",2,8,13,4,33,28,"A",10,"G",9,10,"溫迪爾平原2~4","X","X","Y"),
  new Array(222,"小兔子",2,8,23,5,23,28,"C",10,"G",9,10,"X","X","X","Y"),
  new Array(223,"蛋白石怪(缺)",6,4,8,23,4,28,"A",10,"N","?",10,"蓋雷布倫森林2~4,布拉基姆高地25~29","X","X","N"),
  new Array(224,"紅寶石怪(缺)",6,8,23,23,4,33,"A",6,"N",3,10,"X","X","X","Y"),
  new Array(225,"岩蟲(缺)",6,28,8,23,8,23,"D",2,"N",4,10,"布拉基姆高地40~45","X","X","Y"),
  new Array(226,"水晶怪(缺)",6,18,8,33,4,43,"A",10,"G",5,10,"X","X","X","N"),
  new Array(227,"刀雞(缺)",0,4,8,4,23,8,"D",10,"N","?",10,"蓋雷布倫森林10~14,布拉基姆高地25~29","X","X","N"),
  new Array(228,"劍鴕鳥(缺)",0,4,18,8,23,13,"D",10,"N","?",10,"溫迪爾平原5~9","X","X","N"),
  new Array(229,"大刀鴯苗(缺)",0,4,38,8,33,18,"D",10,"N",3,8,"布拉基姆高地30~34","X","X","Y"),
  new Array(230,"刀鋒阿姆鳥(缺)",0,4,28,8,23,23,"D",10,"N","?",10,"L1恩&#8231;凱迴廊2~4,L2恩&#8231;凱迴廊10~14,L3恩&#8231;凱迴廊20~24","X","X","N"),
  new Array(231,"火蜥蜴(缺)",7,33,18,18,18,28,"C",10,"N","?",10,"L1阿陀羅迴廊2~4,L2阿陀羅迴廊10~14,L3阿陀羅迴廊20~24,盡頭的風穴75~79","X","X","N"),
  new Array(232,"毒蜥蜴(缺)",7,23,8,13,8,18,"A",10,"N","?",10,"蓋雷布倫森林10~14","X","X","N"),
  new Array(233,"冰蜥蜴",7,26,12,33,7,27,"B",10,"N",3,8,"罪之房1樓, L1花羅迴廊2~4,L2花羅迴廊10~14,L3花羅迴廊20~24","罪之房1樓(131,51)","?","Y"),
  new Array(234,"金屬蜥蜴(缺)",7,18,8,33,4,28,"A",10,"S",4,7,"布拉基姆高地35~39","X","X","Y"),
  new Array(235,"戴靴怪(缺)",3,8,9,30,26,26,"A",6,"N",2,8,"法蘭城遺跡2~4,L1威雷迴廊2~4,L2威雷迴廊10~14,L3威雷迴廊20~24","X","X","Y"),
  new Array(236,"舞靴怪(缺)",3,8,13,28,33,8,"C",4,"N",3,8,"蓋雷布倫森林10~14","X","X","Y"),
  new Array(237,"潛靴怪(缺)",3,8,23,8,33,23,"D",4,"N",3,8,"X","X","X","Y"),
  new Array(238,"咚咚靴怪(缺)",3,4,18,23,38,8,"A",10,"N",3,10,"布拉基姆高地30~34","X","X","Y"),
  new Array(239,"大公雞(缺)",9,4,38,4,38,48,"D",10,"G","?",10,"法蘭城遺跡50,蓋雷布倫森林50,溫迪爾平原50","X","X","N"),
  new Array(240,"耶誕靴怪(缺)",3,7,24,13,17,7,"D",10,"G","?",9,"X","X","X","Y"),
  new Array(241,"鑽石怪(缺)",6,28,8,23,8,23,"A",10,"S",3,7,"布拉基姆高地30~34","X","X","Y"),
  new Array(243,"銀獅(缺)",0,18,42,10,29,5,"C",3,"S",5,5,"布拉基姆高地40~45","布拉基姆高地(168,116)(171,117)附近(瀑布上方)","X","Y"),
  new Array(244,"黃銅怪",0,32,21,10,34,18,"A",7,"N",2,6,"X","地之昏神的領域(146,143)(147,141)","X","Y"),
  new Array(245,"鐵獅",0,19,40,11,30,5,"C",10,"N",3,8,"罪之房38~40,盡頭的風穴75~79","罪之房二層(128,55)","?","Y"),
  new Array(246,"紅銅怪(缺)",0,27,30,13,25,19,"B",7,"N",2,6,"X","水之昏神的領域(167,101)(168,107)","X","Y"),
  new Array(247,"跳跳地雷(缺)",6,30,18,16,8,33,"A",10,"N",3,8,"罪之房38~40","罪之房三層(209,224)","?","Y"),
  new Array(248,"碎碎地雷",6,17,27,37,7,17,"C",4,"N",3,8,"X","X","X","Y"),
  new Array(249,"皮皮地雷(缺)",6,13,30,40,7,14,"A",6,"S",3,7,"技能大師宴會任務密道２Ｆ","技能大師宴會任務密道２Ｆ(77,108)附近","X","Y"),
  new Array(251,"龍骨",1,7,37,12,22,27,"D",5,"N",3,8,"布拉基姆高地30~34","X","X","Y"),
  new Array(252,"暗黑龍骨",1,7,47,12,12,27,"D",2,"S",3,5,"X","X","X","Y"),
  new Array(253,"黃金龍骨",1,4,42,8,8,32,"D",5,"S",4,6,"X","布拉基姆高地(236,224)附近(挖掘鐵人任務方向)","X","Y"),
  new Array(255,"走路花妖(缺)",4,8,39,25,10,19,"D",3,"N",3,9,"X","布拉基姆高地(165.243)(蟲洞側)","?","Y"),
  new Array(256,"跑步花妖(缺)",4,13,38,13,13,13,"A",8,"N",3,8,"X","X","X","Y"),
  new Array(261,"???(日文名)",2,26,31,20,24,9,"C",7,"N",2,8,"X","X","X","Y"),
  new Array(307,"愛絲波波",5,34,35,18,19,14,"D",5,"N",1,10,"X","持有30級以上愛絲波波,雙擊雪人改造圖(家族抽獎取得)","X","Y"),
  new Array(1012,"改造大地鼠",0,11,18,25,31,40,"D",3,"X","X",10,"X","1級大地鼠+大地鼠改造圖ABC(未開放)","X","N"),
  new Array(1014,"改造火焰鼠",0,12,17,20,39,37,"B",3,"X","X",10,"X","1級火焰鼠+火焰鼠改造圖ABC(未開放)","X","N"),
  new Array(1022,"改造殭屍",1,41,36,16,16,16,"D",7,"X","X",9,"X","1級殭屍+殭屍改造圖ABC","X","N"),
  new Array(1048,"改造迷你蝙蝠(缺)",2,14,49,4,49,4,"C",10,"X","X",10,"X","1級迷你蝙蝠+迷你蝙蝠改造圖ABCDE(未開放)","X","N"),
  new Array(1072,"改造水蜘蛛",3,28,20,21,24,32,"B",9,"X","X",9,"X","1級水蜘蛛+水蜘蛛改造圖ABCD","X","N"),
  new Array(1085,"改造綠色口臭鬼",4,40,25,18,17,25,"D",2,"X","X",6,"X","1級綠色口臭鬼+綠口臭改造圖ABCD","X","N"),
  new Array(1094,"改造史萊姆(缺)",5,27,15,17,48,16,"D",1,"X","X",9,"X","1級史萊姆+史萊姆改造圖ABC(未開放)","X","N"),
  new Array(1108,"改造純白(旋律)",5,12,27,32,14,40,"A",6,"X","X",9,"X","任何等級純白嚇人箱+純白改造圖ABCDE(未開放)","X","N"),
  new Array(1110,"改造兔耳(陰影)",5,29,25,23,23,25,"A",9,"X","X",6,"X","任何等級兔耳嚇人箱+兔耳改造圖ABCDE","X","N"),
  new Array(1129,"改造蜥蜴戰士",7,31,31,31,31,6,"D",7,"X","X",8,"X","1級蜥蜴戰士+蜥蜴戰士改造圖ABCD(未開放)","X","N"),
  new Array(1134,"改造寒冰翼龍",7,31,31,32,18,13,"B",7,"X","X",6,"X","1級寒冰翼龍+寒冰翼龍改造圖ABCD(未開放)","X","N"),
  new Array(1150,"改造盜賊(缺)",8,25,30,22,33,13,"C",6,"X","X",7,"X","山賊卡+海盜卡+破壞者卡+盜賊改造圖ABCDE(未開放)","X","N"),
  new Array(1154,"改造鳥人",8,20,20,20,40,25,"D",7,"X","X",8,"X","1級鳥人+鳥人改造圖ABCD(未開放)","X","N"),
  new Array(1215,"陸行鯊後期型",2,36,30,36,24,9,"A",7,"X","X",6,"X","持有Lv1陸行鯊+陸行鯊改造圖(由琥珀之卵5任務取得)白天時到法蘭遺跡(88.119)找查爾博士","X","N"),
  new Array(2072,"二改水蜘蛛(缺)",3,32,5,7,29,50,"B",5,"X","X",9,"X","1級改造水蜘蛛+水蜘蛛二次改造圖ABCDE(未開放)","X","N"),
  new Array(2307,"二改愛絲波波",5,37,37,22,22,17,"D",5,"X","X",10,"X","持有30級以下已改造愛絲波波,雙擊雪人二次改造圖(家族新手包抽獎)","X","N"),
  new Array(5004,"優奈",8,15,25,33,19,33,"D",5,"X","X",8,"X","月亮俱樂部任務報酬(97天)",139680,"N"),
  new Array(5075,"快枯死的樹精",4,7,12,17,7,12,"B",4,"X","X",8,"X","黃金樹任務","X","N"),
  new Array(5219,"虛弱的雛鳥",2,5,5,5,5,5,"C",2,"X","X",8,"X","虛弱的雛鳥任務","X","N"),
  new Array(6004,"小可愛優奈",8,28,28,28,28,28,"D",5,"X","X",7,"X","月亮俱樂部任務,一級優奈+流行手冊ABCD(97天*4線)",139680,"N"),
  new Array(9001,"大地牛頭怪",9,22,27,22,27,12,"A",8,"X","X",10,"X","魔力卡2抽獎活動","X","N"),
  new Array(9002,"寒冰牛頭怪",9,22,27,22,27,12,"B",8,"X","X",10,"X","魔力卡2抽獎活動","X","N"),
  new Array(9003,"火焰牛頭怪",9,22,27,22,27,12,"C",8,"X","X",10,"X","魔力卡2抽獎活動","X","N"),
  new Array(9004,"烈風牛頭怪",9,22,27,22,27,12,"D",8,"X","X",10,"X","魔力卡2抽獎活動","X","N"),
  new Array(9005,"熱砂的歐茲尼克(缺)",8,31,40,11,32,8,"C",5,"X","X",10,"X","台灣[遺失的最後寶藏]任務,每星系限一隻,閃+5","X","N")
  )

calculated = false
failure = false
ptList = new Array()
classCalcOpen = true
oType = 1
BPNameList = new Array('體','力','強','速','魔')
BPNL = new Array('體力','力量','強度','速度','魔法')
attNL = new Array('地','水','火','風')
numNL = new Array('零','一','二','三','四','五','六','七','八','九','十')
attCol = new Array('00FF00','00FFFF','FF0000','FFFF00')
statNameList = new Array('血','魔','攻','防','敏','精','回')
raceNames = new Array('野獸系','不死系','飛行系','昆蟲系','植物系','特殊系','金屬系','龍型系','人型系','邪魔系')
picDir = "http://websky.idv.tw/pet_card/pet/sec2fd/"
level=1
base=0.2
inputBackup = ''
ts = new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0) //暫存用
tv = new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0) //暫存用
te = 7 //隨機te檔, 用來計算能力範圍
incompleteText = '(缺)'

function loadMenu(menuIndex) {
  with (document.choose.ptMenu) {
    var itemNum=0
    document.choose.ptMenu.options.length=0;
    if (menuIndex==-1) {
      for (var ptNum in Pts) options[ptNum]=new Option(Pts[ptNum][1],Pts[ptNum][0])
    }
    else {
      for (var ptNum in Pts) {
        if (Pts[ptNum][2]==menuIndex) {
          options[itemNum]=new Option(Pts[ptNum][1],Pts[ptNum][0])
          itemNum++
        }
      }
    }
    choose.ptMenu.options[0].selected=true
    loadData()
  }
}

function findPtType(menuItemIndex) {
  menuItemIndex = parseInt(menuItemIndex)
  if (Pts[menuItemIndex] && (Pts[menuItemIndex][0]==menuItemIndex)) return menuItemIndex
  else for (var ptNum in Pts) if (Pts[ptNum][0] == menuItemIndex) return ptNum
}

function printStarText(num) {
  var line = "<TD><B>" + BPNL[num] + ":</B></TD><TD>"
  if (Pts[ptType][3+num]<10) line += "&nbsp;"
  line += Pts[ptType][3+num] + "&nbsp;" + padc("left",10,printStar(Pts[ptType][3+num])) + "</TD>"
  return line
}

function printAttText(num) {
  var block = "&#9632;"
  var line = "<TD><B>" + attNL[num] + ":</B></TD><TD>"
  var att = Pts[ptType][8].charCodeAt(0) - 65
  var amount = Pts[ptType][9]
  if (att == num) amount = amount
  else if ((att+1)==num || (att-3)==num) amount = 10 - amount
  else amount = 0
  line += pad("right",2,amount) + "&nbsp; <FONT color=#" + attCol[num] + ">"
  for (var i=amount;i--;i<amount) line += block
  amount = 20-amount*2
  for (var i=amount;i--;i<amount) line += "&nbsp;"
  line += "</FONT></TD></TR>"
  return line
}

function loadData() {
  sets = new Array()
  now = new Date()
  if (choose.ptMenu.value<0) {
    inputBackup = choose.input.value
    return
  }
  ptType = findPtType(choose.ptMenu.value)
  oType = choose.outputType.value
  level = parseInt(choose.ptLevel.value)
  var dataText
  //dataText = "<TABLE border=1 bordercolor='#6699CC' style='border: solid table-layout: fixed'><TR><TD><B>圖鑑編號:</B></TD><TD>" + Pts[ptType][0] + "</TD>"
  dataText = "<TABLE border=0 bordercolor='#6699CC' table-layout: fixed'><TR><TD><B>圖鑑編號:</B></TD><TD>" + Pts[ptType][0] + "</TD>"
  dataText += printStarText(0)
  dataText += "<TD><B>圖鑑:</B></TD><TD>"
  if (Pts[ptType][11]=="X") dataText += "無"
  else {
    if (Pts[ptType][11]=="?") dataText += "&nbsp;?級"
    else dataText += numNL[Pts[ptType][11]] + "級"
    if (Pts[ptType][10]=="N") dataText += "普"
    else if (Pts[ptType][10]=="S") dataText += "銀"
    else if (Pts[ptType][10]=="G") dataText += "金"
    else dataText += "&nbsp;?"
    dataText += "卡"
    if (Pts[ptType][16]=="N") dataText += ", 不可封印"
  }
  dataText += "</TD>"
  var picNum = Pts[ptType][0]
  if (choose.showPic.checked) {
    if (picNum>1000 && picNum<9000) picNum %= 1000
    if (picNum<=214) {
      dataText += "<TD rowspan=7 align=center><IMG height='100' width='100' src='" + picDir
      for (var i=0;i<(3-(picNum+"").length);i++) dataText += "0"
      dataText += picNum + ".gif'></TD>"
    }
  }
  dataText += "<TR><TD><B>寵物名:</B></TD><TD>" + padc("left",16,Pts[ptType][1])
  dataText += printStarText(1)
  dataText += printAttText(0)
  dataText += "<TR><TD><B>種族:</B></TD><TD>" + raceNames[Pts[ptType][2]]
  dataText += printStarText(2)
  dataText += printAttText(1)
  dataText += "<TR><TD><B>技能欄:</B></TD><TD>" + Pts[ptType][12]
  dataText += printStarText(3)
  dataText += printAttText(2)
  var totalClass = 0
  for (var i=3;i<8;i++) totalClass += Pts[ptType][i]
  dataText += "<TR><TD><B>總成長:</B></TD><TD>"
  dataText += totalClass
  dataText += printStarText(4)
  dataText += printAttText(3)
  //dataText += "<TR><TD><B>出沒地點</B></TD><TD colspan=6>&nbsp;</TD></TR>"
  dataText += "<TR><TD><B>出沒地點:</B></TD><TD colspan=5 width=600>"
  if (Pts[ptType][13]=="X") dataText += "(未開放/不明)"
  else dataText += Pts[ptType][13]
  dataText += "</TD></TR>"
  dataText += "<TR><TD><B>一級點:</B></TD><TD colspan=3 width=400>"
  if (Pts[ptType][14]=="X") dataText += "(未開放/不明)"
  else dataText += Pts[ptType][14]
  dataText += "</TD><TD><B>出現率:</B></TD><TD>"
  if (Pts[ptType][15]=="?") dataText += "(極低/缺乏資料)"
  else if (Pts[ptType][15]=="X") {
    if (Pts[ptType][11]=="X") dataText += "(無圖鑑, 不可封印)"
    else dataText += "(缺乏資料)"
  }
  else dataText += Pts[ptType][15] + "分鐘"
  dataText += "</TD></TR>"
  dataText += "</TABLE>"
  //for (var i in Pts[ptType]) {
  //  dataText += Pts[ptType][i] + " "
  //}
  //dataText = ''
  //dataText = Math.floor(50*0.2+23*2.7+12*0.3+7*0.3+11*0.2)
  //dataText = Math.floor(10+62.1+3.6+2.1+2.2)
  //choose.data.value = dataText
  printTo('data_area',dataText)
}

//由圖鑑編號判斷一級每檔BP
function calBaseBP(num) {
  //#37使魔, #46小蝙蝠, #9001~#9004牛鬼
  if (num == 37 || num == 46 || num == 9001 || num == 9002 || num == 9003 || num == 9004) return 0.3
  //#2307二改愛絲波波
  else if (num == 2307) return 0.25
  //其他所有寵
  return 0.2
}

function calculate() {
  ptType = undefined
  loadData()
  if (ptType==undefined) {
    helpMessage()
    return
  }
  index = Pts[ptType][0]
  name  = Pts[ptType][1]
  race  = Pts[ptType][2]
  base  = calBaseBP(index)
  parseLines(choose.input.value)
  li = 0
  for (li in sets) {
    parseLine(sets[li])
  }
  if (sets.length==0 || failure) {
    calculated = true
    failure = true
    printTo('helpText','請依<b>血魔攻防敏 精回 體力強速魔</b>順序輸入寵物能力, 每行一隻寵, 然後按<b>開始計算</b>. 精神/回復/BP可以不填.')
    return
  }
  if (choose.clearOutput.checked) o=''
  output()
  calculated = true
  return
}

function parseLines(lines) {
  var tempSets = lines.split(/\n/)
  var j=0
  for (var i in tempSets) {
    tempSets[i] = tempSets[i].split(/[^0-9#]/)
    var nums = new Array()
    var m=0
    for (var k in tempSets[i]) {
      tempSets[i][k] = parseInt(tempSets[i][k])
      if (!isNaN(tempSets[i][k])) {
        nums[m] = tempSets[i][k]
        m++
      }
    }
    tempSets[i] = nums
    if (tempSets[i].length>=5) {
      sets[j] = tempSets[i]
      j++
    }
  }
}

function parseLine(line) {
  numOfResults = 0
  BPClSum= 0
  BPCl   = new Array()
  BPMax  = new Array(5)
  BPMin  = new Array(5)
  cfLoss = new Array(0,0,0,0,0)
  maxLoss = new Array()
  totalLoss = 0
  lossMin = 20
  lossMax = 0
  cfLossSummary = new Array(4,4,4,4,4)
  maxLossSummary = new Array(0,0,0,0,0)
  for (var b=0;b<5;b++) {
    BPCl[b]  = Pts[ptType][b+3]
    BPClSum = BPClSum + BPCl[b]
  }
  //shift entire array if it appears first number represents level
  //this works up to lv 19
  if (line.length>5 && line[0]<20 && line[1]>20) line.shift()
  ptList[li] = new pt(line)
  var p = ptList[li]

//目前野寵會有部份無解, 因為檔次論的野寵公式跟實際野寵能力有誤差
//errorMargin這個參數是為了設定可容許的誤差值, 但程式目前計算野寵有bug, 所以暫設為0
var errorMargin = 0
var loop = 6
if (level==1) {
  loop = 1
  errorMargin = 0
}
for (var gr=0;gr<loop;gr++) {
    for (var b=0;b<5;b++) {
      BPMax[b] = Pts[ptType][b+3] + 10
      BPMin[b] = Pts[ptType][b+3] - 4
    }
    baseBP = (base*1000+(40+gr)*(level-1))/1000
    //add('baseBP = ' + baseBP + '<BR>')
    if (p.BP) {
      //formula is: (base+(40+gr)/1000*(level-1)), gr=0,1,2,3,4,5
      for (var b in BPMax) {
        BPMax[b] = Math.min(BPMax[b],Math.floor((p.BP[b]+1+errorMargin)/baseBP))
        BPMin[b] = Math.max(BPMin[b],Math.ceil((p.BP[b]-errorMargin)/baseBP))
      }
    }
    BPMax[0] = Math.min(BPMax[0],Math.floor((p.stat[0]+1+errorMargin)/8/baseBP))
    BPMax[1] = Math.min(BPMax[1],Math.floor((p.stat[2]+1+errorMargin)/2.7/baseBP))
    BPMax[2] = Math.min(BPMax[2],Math.floor((p.stat[3]+1+errorMargin)/3/baseBP))
    BPMax[3] = Math.min(BPMax[3],Math.floor((p.stat[4]+1+errorMargin)/2/baseBP))
    BPMax[4] = Math.min(BPMax[4],Math.floor((p.stat[1]+1+errorMargin)/10/baseBP))
    //add('Early BPMax = ' + BPMax + '<BR>')
    //add('Early BPMin = ' + BPMin + '<BR>')
    var breaker = 0
    while (true) {
      breaker++
      var total = 0
      for (var q in BPMax) total = total+BPMax[q]-BPMin[q]
      BPMin[0] = Math.min(BPMax[0],Math.max(BPMin[0],Math.ceil((p.stat[0]-errorMargin-(BPMax[1]*2+BPMax[2]*3+BPMax[3]*3+BPMax[4]*1)*baseBP)/8/baseBP)))
      BPMin[1] = Math.min(BPMax[1],Math.max(BPMin[1],Math.ceil((p.stat[2]-errorMargin-(BPMax[0]*2+BPMax[2]*3+BPMax[3]*3+BPMax[4]*2)/10*baseBP)/2.7/baseBP)))
      BPMin[2] = Math.min(BPMax[2],Math.max(BPMin[2],Math.ceil((p.stat[3]-errorMargin-(BPMax[0]*2+BPMax[1]*3+BPMax[3]*3+BPMax[4]*2)/10*baseBP)/3/baseBP)))
      BPMin[3] = Math.min(BPMax[3],Math.max(BPMin[3],Math.ceil((p.stat[4]-errorMargin-(BPMax[0]*1+BPMax[1]*2+BPMax[2]*2+BPMax[4]*1)/10*baseBP)/2/baseBP)))
      BPMin[4] = Math.min(BPMax[4],Math.max(BPMin[4],Math.ceil((p.stat[1]-errorMargin-(BPMax[0]*1+BPMax[1]*2+BPMax[2]*2+BPMax[3]*2)*baseBP)/10/baseBP)))
      BPMax[0] = Math.max(BPMin[0],Math.min(BPMax[0],Math.floor(((p.stat[0]+1+errorMargin)-(BPMin[1]*2+BPMin[2]*3+BPMin[3]*3+BPMin[4]*1)*baseBP)/8/baseBP)))
      BPMax[1] = Math.max(BPMin[1],Math.min(BPMax[1],Math.floor(((p.stat[2]+1+errorMargin)-(BPMin[0]*2+BPMin[2]*3+BPMin[3]*3+BPMin[4]*2)/10*baseBP)/2.7/baseBP)))
      BPMax[2] = Math.max(BPMin[2],Math.min(BPMax[2],Math.floor(((p.stat[3]+1+errorMargin)-(BPMin[0]*2+BPMin[1]*3+BPMin[3]*3+BPMin[4]*2)/10*baseBP)/3/baseBP)))
      BPMax[3] = Math.max(BPMin[3],Math.min(BPMax[3],Math.floor(((p.stat[4]+1+errorMargin)-(BPMin[0]*1+BPMin[1]*2+BPMin[2]*2+BPMin[4]*1)/10*baseBP)/2/baseBP)))
      BPMax[4] = Math.max(BPMin[4],Math.min(BPMax[4],Math.floor(((p.stat[1]+1+errorMargin)-(BPMin[0]*1+BPMin[1]*2+BPMin[2]*2+BPMin[3]*2)*baseBP)/10/baseBP)))
      for (var q in BPMax) total = total-BPMax[q]+BPMin[q]
      if (total > 70 || total == 0 || breaker > 20) break;
    }
    //add('Gr    = ' + gr    + ' | ')
    //add('BPMax = ' + BPMax + ' | ')
    //add('BPMin = ' + BPMin + '<BR>')
    for (var a=BPMin[0];a<=BPMax[0];a++) {
      for (var b=BPMin[1];b<=BPMax[1];b++) {
        for (var c=BPMin[2];c<=BPMax[2];c++) {
          for (var d=BPMin[3];d<=BPMax[3];d++) {
            for (var e=BPMin[4];e<=BPMax[4];e++) {
              var cor = true
              var combo = new Array(a,b,c,d,e)
              for (var co in p.stat) {
                var thisStat = Math.floor(stat(co,a,b,c,d,e)*baseBP)
                if (level==1) cor = cor && thisStat == p.stat[co]
                else cor = cor && (Math.abs(thisStat-p.stat[co]) <= errorMargin)
                //add((Math.floor(stat(co,a,b,c,d,e)*baseBP) + 'vs' + p.stat[co]) + ' | ')
              }
              var sum = a+b+c+d+e
              cor = cor && ((BPClSum+10) >= sum)
              cor = cor && ((BPClSum-10) <= sum)
              if (cor && doCheckBP) {
                for (var x=0;x<5;x++) {
                  eval("cor = cor && (Math.floor(baseBP*"+String.fromCharCode(97+x)+")==p.BP[x])")
                }
                //add("BP check: " + baseBP*a + ' vs ' + p.BP[0] + "<BR>")
                //add("BP check: " + baseBP*b + ' vs ' + p.BP[0] + "<BR>")
                //add("BP check: " + baseBP*c + ' vs ' + p.BP[0] + "<BR>")
                //add("BP check: " + baseBP*d + ' vs ' + p.BP[0] + "<BR>")
                //add("BP check: " + baseBP*e + ' vs ' + p.BP[0] + "<BR>")
              }
              if (cor) {
                var sureLoss = Math.max(0,BPCl[0]-a)+Math.max(0,BPCl[1]-b)+
                  Math.max(0,BPCl[2]-c)+Math.max(0,BPCl[3]-d)+Math.max(0,BPCl[4]-e)
                totalLoss = BPClSum+10-sum
                if (sureLoss>totalLoss) cor = false
              }
              if (cor && p.spi!=undefined) {
                var thisSpi = Math.floor(spi(combo)*baseBP+100)
                if (level==1) cor = cor && (p.spi==thisSpi)
                else cor = cor && (Math.abs(thisSpi-p.spi) <= errorMargin)
                //add('p.spi = ' + p.spi + ' vs ' + 'cal = ' + Math.floor(spi(combo)*baseBP+100))
              }
              if (cor && p.rev!=undefined) {
                var thisRev = Math.floor(rev(combo)*baseBP+100)
                if (level==1) cor = cor && (p.rev==thisRev)
                else cor = cor && (Math.abs(thisRev-p.rev) <= errorMargin)
                //add('p.rev = ' + p.rev + ' vs ' + 'cal = ' + Math.floor(rev(combo)*baseBP+100))
              }
              if (cor) {
                var solution = new Array(a,b,c,d,e)
                p.sols[numOfResults] = new sol(solution,gr)
                numOfResults++
              }
            }
          }
        }
      }
    }
  }
//END OF INDEX USE

  if (numOfResults>0) {
    p.lossMin = 20
    p.lossMax = 0
    p.cfLossSummary = new Array(4,4,4,4,4)
    p.maxLossSummary = new Array(0,0,0,0,0)
    if (p.spi==undefined) p.spi = Math.floor(p.sols[0].spi)
    if (p.rev==undefined) p.rev = Math.floor(p.sols[0].rev)
    if (p.BP==undefined) {
      p.BP = new Array(5)
      for (var st=0;st<5;st++) p.BP[st] = Math.floor(p.sols[0].BP[st])
    }
  }
  for (var r=0;r<numOfResults;r++) {
    if (p.spi == undefined || (Math.floor(p.sols[r].spi) != p.spi)) p.spi = undefined
    if (p.rev == undefined || (Math.floor(p.sols[r].rev) != p.rev)) p.rev = undefined
    if (!doCheckBP) {
      //possible performance improvement here?
      for (var st=0;st<5;st++) {
        if (p.BP[st]==undefined) break
        else if (p.BP[st] != Math.floor(p.sols[r].BP[st])) p.BP[st] = undefined
      }
    }
    totalLoss = BPClSum+10
    for (var st=0;st<5;st++) {
      p.sols[r].cfLoss[st] = Math.max(0,BPCl[st]-p.sols[r].cl[st])
      totalLoss -= p.sols[r].cl[st]
    }
    var minLoss = Math.max(0,totalLoss-16)
    for (var st=0;st<5;st++) {
      p.sols[r].cfLoss[st] = Math.max(p.sols[r].cfLoss[st],minLoss)
      p.cfLossSummary[st] = Math.min(p.sols[r].cfLoss[st],p.cfLossSummary[st])
    }
    p.sols[r].loss = totalLoss
    p.lossMin = Math.min(p.lossMin,totalLoss)
    p.lossMax = Math.max(p.lossMax,totalLoss)
    var unCfLoss = totalLoss
    for (var st=0;st<5;st++) unCfLoss -= p.sols[r].cfLoss[st]
    for (var st=0;st<5;st++) {
      p.sols[r].maxLoss[st] = Math.min(unCfLoss+p.sols[r].cfLoss[st],4)
      p.maxLossSummary[st] = Math.max(p.sols[r].maxLoss[st],p.maxLossSummary[st])
    }
  }
  for (var st=0;st<5;st++) p.stat[st]+=20
}

function output() {
  if (ptList.length==1) add('<B>' + name + '能力分析:</B><BR><FONT FACE="細明體,Courier,System,MS Sans Serif">')
  else add('<B>' + ptList.length + '隻' + name + '能力分布:</B><BR><FONT FACE="細明體,Courier,System,MS Sans Serif">')
  var maxStat = new Array(5)
  var minStat = new Array(5)
  //note: undefined values are ignored, and possible utilisation of sol data
  //      to determine max/min is NOT implmented
  var maxBP = new Array(5)
  var minBP = new Array(5)
  var maxSpi, maxRev, minSpi, minRev, maxLoss, minLoss
  var minCfLoss = new Array(5)
  var minMaxLoss = new Array(5)
  var maxCfLoss = new Array(5)
  var maxMaxLoss = new Array(5)
  var lossLeftLen=2, lossRightLen=2
  //TO DO: add Switch later for printSR
  var printSR = true

  //finding max and min values
  for (var st=0;st<5;st++) {
    maxStat[st] = ptList[0].stat[st]
    minStat[st] = ptList[0].stat[st]
    if (ptList[0].sols!=undefined && ptList[0].sols.length>0) {
      if (ptList[0].BP[st]) {
        maxBP[st] = ptList[0].BP[st]
        minBP[st] = ptList[0].BP[st]
      }
    }
  }
  for (var p in ptList) {
    for (var st=0;st<5;st++) {
      maxStat[st] = Math.max(maxStat[st],ptList[p].stat[st])
      minStat[st] = Math.min(minStat[st],ptList[p].stat[st])
      if (ptList[p].BP!= undefined && ptList[p].BP[st]) {
        if (maxBP[st]==undefined) {
          maxBP[st] = ptList[p].BP[st]
          minBP[st] = ptList[p].BP[st]
        }
        else {
          maxBP[st] = Math.max(maxBP[st],ptList[p].BP[st])
          minBP[st] = Math.min(minBP[st],ptList[p].BP[st])
        }
      }
    }
    if (ptList[p].sols.length>0) {
      if (maxLoss==undefined) {
        maxLoss = ptList[p].lossMin*100+ptList[p].lossMax
        minLoss = ptList[p].lossMin*100+ptList[p].lossMax
        for (var st=0;st<5;st++) {
          minCfLoss[st] = ptList[p].cfLossSummary[st]
          maxCfLoss[st] = ptList[p].cfLossSummary[st]
          minMaxLoss[st] = ptList[p].maxLossSummary[st]
          maxMaxLoss[st] = ptList[p].maxLossSummary[st]
        }
      }
      else {
        var thisLoss = ptList[p].lossMin*100+ptList[p].lossMax
        if (thisLoss > maxLoss) {
          maxLoss = thisLoss
          for (var st=0;st<5;st++) {
            maxCfLoss[st] = ptList[p].cfLossSummary[st]
            maxMaxLoss[st] = ptList[p].maxLossSummary[st]
          }
        }
        if (thisLoss < minLoss) {
          minLoss = thisLoss
          for (var st=0;st<5;st++) {
            minCfLoss[st] = ptList[p].cfLossSummary[st]
            minMaxLoss[st] = ptList[p].maxLossSummary[st]
          }
        }
      }
      if (lossRightLen==2 && ptList[p].lossMax>9 && (ptList[p].lossMax!=ptList[p].lossMin)) lossRightLen = 3
    }
    if (printSR) {
      if (ptList[p].spi!=undefined) {
        if (maxSpi==undefined) {
          maxSpi = ptList[p].spi
          minSpi = ptList[p].spi
        }
        else {
          maxSpi = Math.max(maxSpi,ptList[p].spi)
          minSpi = Math.min(minSpi,ptList[p].spi)
        }
      }
      if (ptList[p].rev!=undefined) {
        if (maxRev==undefined) {
          maxRev = ptList[p].rev
          minRev = ptList[p].rev
        }
        else {
          maxRev = Math.max(maxRev,ptList[p].rev)
          minRev = Math.min(minRev,ptList[p].rev)
        }
      }
    }
  }
  if (maxLoss>=1000) lossLeftLen=3
  var solLossPad = Math.max(lossLeftLen, lossRightLen)
  var checkUndefined = new Array('maxSpi', 'maxRev', 'minSpi', 'minRev', 'maxLoss', 'minLoss')
  for (var st in checkUndefined) if (!eval(checkUndefined[st])) eval(checkUndefined[st] + "='?'")
  for (var st=0;st<5;st++) {
    if (!maxBP[st]) maxBP[st]='?'
    if (!minBP[st]) minBP[st]='?'
  }
//actual printing bit start here:
  var ptL = Math.max((((ptList.length+1) + "").length + 2),4)
  var lineOutput = ""
  if (oType!=1 && ptList.length!=1) lineOutput += padc("right",4,"編號")
  for (var i=0;i<5;i++) {
    lineOutput += padc("right",(maxStat[i]+"").length,statNameList[i]) + '&nbsp;'
    if (oType==1) lineOutput += '&nbsp;&nbsp;&nbsp;'
  }
  lineOutput += padc("right",(maxSpi+"").length,statNameList[5]) + '&nbsp;'
  if (oType==1) lineOutput += '&nbsp;&nbsp;&nbsp;'
  lineOutput += padc("right",(maxRev+"").length,statNameList[6]) + '&nbsp;'
  if (oType==1) lineOutput += '&nbsp;&nbsp;&nbsp;'
  for (var i=0;i<5;i++) {
    if (i!=0 && (maxBP[0]+"").length>1 && (maxBP[i]+"").length>1) lineOutput += '&nbsp;'
    lineOutput += padc("right",(maxBP[i]+"").length,BPNameList[i])
    if (oType==1) lineOutput+='&nbsp;&nbsp;'
  }
  if (!isNaN(maxLoss)) {
    lineOutput += padc("right",lossLeftLen,"檔")
    if (oType!=1) {
      lineOutput += pad("right",lossRightLen+3,"") + '&nbsp;'
      lineOutput += "至少掉&nbsp;&nbsp;&nbsp;&nbsp;最多掉"
    }
    else lineOutput += "&nbsp;至少掉最多掉"
  }
  lineOutput += "<BR>"
  for (var p in ptList) {
    p = parseInt(p)
    if (ptList.length!=1) {
      lineOutput += pad("right",ptL,("#" + (p+1) + ":"))
      if (oType == 1) lineOutput += "<BR>"
    }
    for (var st=0;st<5;st++) {
      lineOutput += pad("right",(maxStat[st]+"").length,ptList[p].stat[st]) + '&nbsp;'
      if (oType==1) lineOutput += '&nbsp;&nbsp;&nbsp;'
    }
    if (printSR) {
      lineOutput += pad("right",(maxSpi+"").length,ptList[p].spi) + '&nbsp;'
      if (oType==1) lineOutput += '&nbsp;&nbsp;&nbsp;'
      lineOutput += pad("right",(maxRev+"").length,ptList[p].rev) + '&nbsp;'
      if (oType==1) lineOutput += '&nbsp;&nbsp;&nbsp;'
    }
    for (var st=0;st<5;st++) {
      if (ptList[p].BP==undefined) lineOutput += pad("right",(maxBP[st]+"").length,undefined) + '&nbsp;'
      else lineOutput += pad("right",(maxBP[st]+"").length,ptList[p].BP[st]) + '&nbsp;'
      if (oType==1) lineOutput+='&nbsp;&nbsp;'
    }
    if (ptList[p].cfLossSummary==undefined) {
      lineOutput += "無解<BR>"
    }
    else {
      if (oType!=1) lineOutput += pad("right",lossLeftLen,"-" + ptList[p].lossMin)
      if (ptList[p].lossMin!=ptList[p].lossMax) {
        if (oType==1) lineOutput += pad("right",lossLeftLen,"-?") + '&nbsp;'
        else lineOutput += " ~ " + pad("right",lossRightLen,"-" + ptList[p].lossMax) + '&nbsp;'
      }
      else if (oType==1) lineOutput += pad("right",lossLeftLen,"-" + ptList[p].lossMin) + '&nbsp;'
      else lineOutput += pad("right",lossRightLen+3,"") + '&nbsp;'
      if (oType==1) {
        for (var st=0;st<5;st++) lineOutput+=ptList[p].cfLossSummary[st]
        lineOutput += '&nbsp;'
        for (var st=0;st<5;st++) lineOutput+=ptList[p].maxLossSummary[st]
        lineOutput += '<BR>'
      }
      else lineOutput += ptList[p].cfLossSummary + '&nbsp;' + ptList[p].maxLossSummary + '<BR>'
    }

    if (oType==1 && ptList[p].sols.length>0) {
      var solLine = ""
      for (var s in ptList[p].sols) {
        for (var st in ptList[p].sols[s].stat) {
          solLine += pad("right",(maxStat[st]+"").length+3,ptList[p].sols[s].stat[st].toFixed(2)) + '&nbsp;'
        }
        solLine += pad("right",(maxSpi+"").length+3,ptList[p].sols[s].spi.toFixed(2)) + '&nbsp;' + pad("right",(maxRev+"").length+3,ptList[p].sols[s].rev.toFixed(2)) + '&nbsp;'
        for (var b in ptList[p].sols[s].BP) {
          solLine += pad("right",(maxBP[st]+"").length+2,ptList[p].sols[s].BP[b].toFixed(1)) + '&nbsp;'
        }
        solLine += pad("right",solLossPad,'-' + ptList[p].sols[s].loss) + '&nbsp;'
        for (var st=0;st<5;st++) solLine+=ptList[p].sols[s].cfLoss[st]
        solLine += '&nbsp;'
        for (var st=0;st<5;st++) solLine+=ptList[p].sols[s].maxLoss[st]
        solLine += '<BR>'
      }
      solLine += '<BR>'
      lineOutput += solLine
    }
    if ((p%2)==0)  {
      add(lineOutput)
      lineOutput = ""
    }
  }
  //need to account for 0 after % operation

  if (ptList.length>1) {
    lineOutput += "<BR>"
    lineOutput += pad("right",ptL,"Max:")
    for (var st=0;st<5;st++) lineOutput += pad("right",(maxStat[st]+"").length,maxStat[st]) + '&nbsp;'
    if (printSR) lineOutput += pad("right",(maxSpi+"").length,maxSpi) + '&nbsp;' + pad("right",(maxRev+"").length,maxRev) + '&nbsp;'
    for (var st=0;st<5;st++) lineOutput += pad("right",(maxBP[st]+"").length,maxBP[st]) + '&nbsp;'
    if (isNaN(maxLoss)) lineOutput+="全部無解.<BR>"
    else {
      if (isNaN(minLoss)) minLoss = 0
      lineOutput += pad("right",lossLeftLen,"-" + Math.floor(minLoss/100))
      if (Math.floor(minLoss/100)!=(minLoss%100)) lineOutput += ' ~ ' + pad("right",lossRightLen,"-" + (minLoss%100)) + '&nbsp;'
      else lineOutput += pad("right",lossRightLen+3,"") + '&nbsp;'
      lineOutput += minCfLoss + '&nbsp;' + minMaxLoss + '<BR>'
    }
    lineOutput += pad("right",ptL,"Min:")
    for (var st=0;st<5;st++) lineOutput += pad("right",(maxStat[st]+"").length,minStat[st]) + '&nbsp;'
    if (printSR) lineOutput += pad("right",(maxSpi+"").length,minSpi) + '&nbsp;' + pad("right",(maxRev+"").length,minRev) + '&nbsp;'
    for (var st=0;st<5;st++) lineOutput += pad("right",(maxBP[st]+"").length,minBP[st]) + '&nbsp;'
    if (isNaN(maxLoss)) lineOutput+="全部無解.<BR>"
    else {
      lineOutput += pad("right",lossLeftLen,"-" + Math.floor(maxLoss/100))
      if (Math.floor(maxLoss/100)!=(maxLoss%100)) lineOutput += ' ~ ' + pad("right",lossRightLen,"-" + (maxLoss%100)) + '&nbsp;'
      else lineOutput += pad("right",lossRightLen+3,"") + '&nbsp;'
      lineOutput += maxCfLoss + '&nbsp;' + maxMaxLoss + '<BR>'
    }
  }

  ptList = new Array()
  end = new Date()
  //if (name.length > incompleteText.length && name.substring(name.length-incompleteText.length)==incompleteText) {
  if (name.substring(name.length-incompleteText.length)==incompleteText) {
    lineOutput += '<BR>檔次有缺, 以上計算結果僅供參考, 歡迎提供成長紀錄以補齊檔次.<BR>成長紀錄只需要練過後的能力值,配點方式,補抓時的等級還有現有等級即可, 不用每級紀錄.<BR>'
  }
  lineOutput += '</FONT><BR>共費 ' + (end-now)/1000 + ' 秒<BR>'
  lineOutput += '<HR NOSHADE COLOR="#6699CC">'
  add(lineOutput)
  printTo('myDiv3',o)
  printTo('helpText',"計算完畢.")
}

function pad(pos,len,text) {
  if (text==undefined) text = '?'
  text = ""+text
  len = (len-text.length)
  if (pos=="right") {
    for (var pa=0;pa<len;pa++) {
      text = "&nbsp;" + text
    }
    return text
  }
  if (pos=="center") {
    for (var pa=0;pa<Math.floor(len/2);pa++) {
      text = "&nbsp;" + text
    }
    for (var pa=0;pa<Math.ceil(len/2);pa++) {
      text = text + "&nbsp;"
    }
    return text
  }
  if (pos=="left") {
    for (var pa=0;pa<len;pa++) {
      text = text + "&nbsp;"
    }
    return text
  }
}

function padc(pos,len,text) {
  if (text==undefined) text = '?'
  text = ""+text
  len = (len-text.length*2)
  //處理半型括號被當成兩格的問題, 假設括號一定成對出現
  if (/[\(-\)]/g.test(text)) len += 2
  if (pos=="right") {
    for (var pa=0;pa<len;pa++) {
      text = "&nbsp;" + text
    }
    return text
  }
  if (pos=="center") {
    for (var pa=0;pa<Math.floor(len/2);pa++) {
      text = "&nbsp;" + text
    }
    for (var pa=0;pa<Math.ceil(len/2);pa++) {
      text = text + "&nbsp;"
    }
    return text
  }
  if (pos=="left") {
    for (var pa=0;pa<len;pa++) {
      text = text + "&nbsp;"
    }
    return text
  }
}

function rev(list) {
  return ((list[0]*8 - list[1] - list[2] + list[3]*2 - list[4]*3) / 10)
}

function spi(list) {
  return ((-list[0]*3 - list[1] + list[2]*2 - list[3]*1 + list[4]*8) / 10)
}

function stat(type,a,b,c,d,e) {
  if (arguments.length==2) {
    return stat(type,arguments[1][0],arguments[1][1],arguments[1][2],arguments[1][3],arguments[1][4])
  }
  var precision = 3
  a = a.toFixed(precision)
  b = b.toFixed(precision)
  c = c.toFixed(precision)
  d = d.toFixed(precision)
  e = e.toFixed(precision)
  type = parseInt(type)
  switch (type) {
    case 0 : return a*8+b*2+c*3+d*3+e*1
    case 1 : return a*1+b*2+c*2+d*2+e*10
    case 2 : return (a*2+b*27+c*3+d*3+e*2)/10
    case 3 : return (a*2+b*3+c*30+d*3+e*2)/10
    default: return (a*1+b*2+c*2+d*20+e*1)/10
  }
}

function getRefToDiv(divID) {
    if( document.layers ) { //Netscape layers
        return document.layers[divID]; }
    if( document.getElementById ) { //DOM; IE5, NS6, Mozilla, Opera
        return document.getElementById(divID); }
    if( document.all ) { //Proprietary DOM; IE4
        return document.all[divID]; }
    return false;
}

function add(text) {o+=text}

function printTo(divID, text) {
  if (divID=='helpText') text+= '<HR NOSHADE COLOR="#6699CC">'
  myRef = getRefToDiv(divID)
  if( typeof( myRef.innerHTML ) != 'undefined' ) {
    //used by the IE series, Konqueror, Opera 7+ and Gecko browsers
    myRef.innerHTML = text;
  } else {
    if( myRef.document && myRef.document != window.document ) {
      //used by layers browsers
      myRef.document.open();
      myRef.document.write(text);
      myRef.document.close();
    } else {
      if( window.frames && window.frames.length && window.frames['nameOfIframe'] ) {
        //used by browsers like Opera 6-
        myRef = window.frames['nameOfIframe'].window;
        myRef.document.open();
        myRef.document.write(text);
        myRef.document.close();
      }
    }
  }
}

function showDiv(divID) {
    myRef = getRefToDiv(divID)
    if( !myRef ) return
    if( myRef.style ) myRef.style.visibility = 'visible'
    else if( myRef.visibility ) myRef.visibility = 'show'
    return
}

function hideDiv(divID) {
    myRef = getRefToDiv(divID)
    if( !myRef ) return
    if( myRef.style ) myRef.style.visibility = 'hidden'
    else if( myRef.visibility ) myRef.visibility = 'hide'
    return
}

function helpMessage() {
  if (isNaN(parseInt(choose.ptLevel.value))) {
    printTo('helpText','等級欄請填數字.')
    return
  }
  if (failure) {
    printTo('helpText','請檢查數據並依<b>血魔攻防敏 精回 體力強速魔</b>順序輸入寵物能力, 每行一隻寵, 然後按<b>開始計算</b>. 精神/回復/BP可以不填.')
    return
  }
  if (choose.ptMenu.value=="-1") {
    printTo('helpText','請選取欲計算的寵物.')
  }
  else if (choose.input.value=='')
    printTo('helpText','請依<b>血魔攻防敏 精回 體力強速魔</b>順序輸入寵物能力, 每行一隻寵, 然後按<b>開始計算</b>. 精神/回復/BP可以不填.')
  else if (calculated && !failure) printTo('helpText','計算完畢.')
  else printTo('helpText','準備就緒, 可以開始計算.')
  return
}

function notDone() {
  calculated = false
  failure = false
}

function clearInput() {
  if (choose.input.value!='') inputBackup = choose.input.value
  choose.input.value=''
}

function restoreInput() {
  if (inputBackup!='') choose.input.value = inputBackup
  notDone()
}

function copyDiv() {
  var old = choose.input.value
  choose.input.value = getRefToDiv("myDiv3").innerText
  var r = choose.input.createTextRange()
  r.select()
  r.execCommand('copy')
  choose.input.value = old
}

function printStar(num) {
  var star = "&#9733;"
  var hStar = "&#9734;"
  var line = ""
  while (num>=10) {
    line += star
    num -= 10
  }
  if (num>=8) line += star
  else if (num>=3) line += hStar
  return line
}

function toggleCalc() {
  if (classCalcOpen) {
    hideDiv('classCalc')
    showDiv('sim')
    classCalcOpen=false
    printTo('switch','切換至一級寵物檔次計算機')
    printTo('heading','寵物成長模擬')
  }
  else {
    hideDiv('sim')
    showDiv('classCalc')
    classCalcOpen=true
    printTo('switch','切換至寵物成長模擬')
    printTo('heading','一級寵物檔次計算機')
  }
}

//全寵物能力範圍表:
function createStatRangeTable() {
  level = parseInt(choose.ptLevel.value)
  var titleString = ""
  if (level==1) titleString += "全寵物一"
  else titleString += "野生寵" + level
  titleString += "級能力範圍表"
  var srtText = "<HTML><TITLE>" + titleString + "</TITLE><BODY BGCOLOR=#FFFFFF><h1>" + titleString + "</h1>"
  //計算能力範圍
  var statRange = calStatRange()
  //排版
  srtText += "<TABLE BORDER=5 BGCOLOR='#FFFFFF' bordercolor='#6699CC'><TBODY ALIGN='center'><TR><TD rowspan=2><B>編號</B></TD><TD rowspan=2><B>寵物名</B></TD>"
  srtText += "<TD colspan=12><B>單項能力範圍</B><small>(同隻寵不會同時有兩項五圍是頂的)</small></TD><TD></TD><TD colspan=12><B>滿檔/底檔寵能力參考</B><small>(隨機檔平均分布)</small></TD></TR>"
  for (var j=0;j<2;j++) {
    for (var i in statNameList) {
      srtText += "<TD><B>" + statNameList[i] + "</B></TD>"
    }
    for (var i in BPNameList) {
      srtText += "<TD><B>" + BPNameList[i] + "</B></TD>"
    }
    if (j==0) srtText += "<TD></TD>"
  }
  srtText += "</TR></TBODY>"
  for (var i in statRange) {
    var srtTextTemp = ""
    srtTextTemp += "<TR><TBODY ALIGN='right'><TD rowspan=2>" + statRange[i][0] + "</TD>" + "<TD rowspan=2 align='center'>" + statRange[i][1] + "</TD>"
    for (var j=2;j<14;j++) {
      srtTextTemp += "<TD>" + statRange[i][j] + "</TD>"
    }
    srtTextTemp +="<TD></TD>"
    for (var j=26;j<38;j++) {
      srtTextTemp += "<TD>" + statRange[i][j] + "</TD>"
    }
    srtTextTemp += "</TR>"
    for (var j=14;j<26;j++) {
      srtTextTemp += "<TD>" + statRange[i][j] + "</TD>"
    }
    srtTextTemp +="<TD></TD>"
    for (var j=38;j<50;j++) {
      srtTextTemp += "<TD>" + statRange[i][j] + "</TD>"
    }
    srtTextTemp += "</TR>"
    srtText += srtTextTemp
  }
  srtText += "</TBODY></TABLE><BR>" +
             "<B>註1.</B> 全能力同時達到單項能力上限是不可能的.<BR>" +
             "<B>註2.</B> 達到部份上下限的機率約為 1/(5^12) ~= 兩億四千四百萬分之一<BR>" +
             "<B>註3.</B> 以上為野寵能力, 部分地區的怪或王經過大宇/ENIX手動調整, 所以能力將超出上列範圍.<BR>" +
             "<B>註4.</B> 寵名有標明 (缺) 的寵物無法正確計算能力範圍, 能力上下限都會低估.<BR>" +
             "<B>註5.</B> 滿檔寵能力參考是以隨機檔(2 2 2 2 2)配上頂成長係數(5)的方式計算, 野寵成長係數如果低於5, 滿檔能力會較列出的值低. 底檔寵如成長係數非0, 也會比列出值高.<BR>" +
             "</HTML>"
  return srtText
}

function printStat() {
  if (isNaN(parseInt(choose.ptLevel.value))) {
    helpMessage()
    return
  }
  OpenWindow=window.open("", "newwin", "")
  OpenWindow.document.write(createStatRangeTable())
  OpenWindow.document.close()
}

//能力範圍如以下方式計算(如te設為7, 超過此範圍的機率大都低於百萬分之一, 不予考慮, 以讓數據相對合理化):
//五圍上限 - 總成長滿檔+該寵隨機te檔配在能把該能力最大化的位置上, 其餘(10-te)檔配在第二好的位置.
//五圍下限 - 總成長底檔+該寵隨機te檔配在能把該能力最小化的位置上, 其餘(10-te)檔配在第二差的位置.
//精神上限 - 防魔滿檔, 體力速底檔, 該寵隨機te檔配在魔, (10-te)檔配在強.
//精神下限 - 防魔底檔, 體力速滿檔, 該寵隨機te檔配在體, (10-te)檔配在力.
//回復上限 - 體速滿檔, 力強魔底檔, 該寵隨機te檔配在體, (10-te)檔配在速.
//回復下限 - 體速底檔, 力強魔滿檔, 該寵隨機te檔配在魔, (10-te)檔配在力.
//BP上限 - 頂檔次*每檔BP + te*每檔BP
//BP下限 - 底檔次*每檔BP
//野寵以成長係數5用來計算能力上限, 成長係數0計算下限
function calStatRange() {
  var statRange = new Array(Pts.length)
  for (var i in Pts) {
    //計算各能力上限, 填到暫存變數ts中
    calStatMax(i)
    //計算各能力上限, 填到暫存變數tv中
    calStatMin(i)
    statRange[i] = new Array(Pts[i][0],Pts[i][1],0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
    for (var j=0;j<12;j++) {
      statRange[i][j+2]  = ts[j]
      statRange[i][j+14] = tv[j]
      statRange[i][j+26] = ts[j+12]
      statRange[i][j+38] = tv[j+12]
    }
  }
  return statRange
}

function calStatMax(num) {
  var baseBP = (calBaseBP(num)*1000+(40+5)*(level-1))/1000
  for (var k=0;k<5;k++) {
    k = parseInt(k)
    switch (k) {
      case 0 : ts[0] = Math.floor(((Pts[num][3]+te)*8+ Pts[num][4]       * 2+(Pts[num][5]+10-te)* 3+ Pts[num][6]       * 3+ Pts[num][7]    * 1)    *baseBP+20)
      case 1 : ts[1] = Math.floor(( Pts[num][3]    *1+ Pts[num][4]       * 2+ Pts[num][5]       * 2+(Pts[num][6]+10-te)* 2+(Pts[num][7]+te)*10)    *baseBP+20)
      case 2 : ts[2] = Math.floor(((Pts[num][3]    *2+(Pts[num][4]+te)   *27+(Pts[num][5]+10-te)* 3+ Pts[num][6]       * 3+ Pts[num][7]    * 2)/10)*baseBP+20)
      case 3 : ts[3] = Math.floor(((Pts[num][3]    *2+(Pts[num][4]+10-te)* 3+(Pts[num][5]+te)   *30+ Pts[num][6]       * 3+ Pts[num][7]    * 2)/10)*baseBP+20)
      default: ts[4] = Math.floor(((Pts[num][3]    *1+(Pts[num][4]+10-te)* 2+ Pts[num][5]    *    2+(Pts[num][6]+te)   *20+ Pts[num][7]    * 1)/10)*baseBP+20)
    }
  }
  ts[5]  = Math.floor(((-(Pts[num][3]-4 )*3 - (Pts[num][4]-4)*1 + (Pts[num][5]+10-te)*2 - (Pts[num][6]-4)*1 + (Pts[num][7]+te)*8) / 10)*baseBP + 100)
  ts[6]  = Math.floor((( (Pts[num][3]+te)*8 - (Pts[num][4]-4) - (Pts[num][5]-4) + (Pts[num][6]+10-te)*2 - (Pts[num][7]-4)*3)      / 10)*baseBP + 100)
  for (var k= 7;k<12;k++) ts[k] = Math.floor((Pts[num][3+k-7]+te)*baseBP)
  for (var k=12;k<17;k++) ts[k] = Math.floor(stat(k-12,Pts[num][3]+2,Pts[num][4]+2,Pts[num][5]+2,Pts[num][6]+2,Pts[num][7]+2)*baseBP + 20)
  ts[17] = Math.floor(((-(Pts[num][3]+2 )*3 - (Pts[num][4]+2)*1 + (Pts[num][5]+2)*2 - (Pts[num][6]+2)*1 + (Pts[num][7]+2)*8) / 10)*baseBP + 100)
  ts[18] = Math.floor((( (Pts[num][3]+2 )*8 - (Pts[num][4]+2) - (Pts[num][5]+2) + (Pts[num][6]+2)*2 - (Pts[num][7]+2)*3)     / 10)*baseBP + 100)
  for (var k=19;k<24;k++) ts[k] = Math.floor((Pts[num][3+k-19]+2)*baseBP)
  return
}

function calStatMin(num) {
  var baseBP = (calBaseBP(num)*1000+(40+0)*(level-1))/1000
  var a = new Array(0,0,0,0,0)
  for (var i=0;i<5;i++) {
    a[i] = Pts[num][3+i] - 4
  }
  for (var k=0;k<5;k++) {
    k = parseInt(k)
    switch (k) {
      case 0 : tv[0] = Math.floor((  a[0]    *8+(a[1]+10-te)* 2+a[2]* 3+a[3]* 3+(a[4]+te)* 1)*baseBP+20)
      case 1 : tv[1] = Math.floor(( (a[0]+te)*1+(a[1]+10-te)* 2+a[2]* 2+a[3]* 2+ a[4]*10    )*baseBP+20)
      case 2 : tv[2] = Math.floor((((a[0]+10)*2+ a[1]       *27+a[2]* 3+a[3]* 3+ a[4]* 2)/10)*baseBP+20)
      case 3 : tv[3] = Math.floor((((a[0]+10)*2+ a[1]       * 3+a[2]*30+a[3]* 3+ a[4]* 2)/10)*baseBP+20)
      default: tv[4] = Math.floor((((a[0]+10)*1+ a[1]       * 2+a[2]* 2+a[3]*20+ a[4]* 1)/10)*baseBP+20)
    }
  }
  tv[5] = Math.floor(((-(a[0]+te)*3 - (a[1]+4+10-te) + a[2]*2 - (a[3]+4) + a[4] *8) / 10)*baseBP + 100)
  tv[6] = Math.floor(((a[0]*8 - (a[1]+4+10-te) - (a[2]+4) + a[3]*2 - (a[4]+4+te)*3) / 10)*baseBP + 100)
  for (var k=7;k<12;k++) tv[k] = Math.floor(a[k-7]*baseBP)
  for (var k=12;k<17;k++) tv[k] = Math.floor(stat(k-12,a[0]+2,a[1]+2,a[2]+2,a[3]+2,a[4]+2)*baseBP + 20)
  tv[17] = Math.floor(((-(a[0]+2 )*3 - (a[1]+2) + (a[2]+2)*2 - (a[3]+2)*1 + (a[4]+2)*8) / 10)*baseBP + 100)
  tv[18] = Math.floor((( (a[0]+2 )*8 - (a[1]+2) - (a[2]+2)   + (a[3]+2)*2 - (a[4]+2)*3) / 10)*baseBP + 100)
  for (var k=19;k<24;k++) tv[k] = Math.floor((a[k-19]+2)*baseBP)
  return
}

//-->
</SCRIPT>

</HEAD>
<BODY TEXT="#000000" LINK="#0000FF" VLINK="#FF0000" ALINK="#00A000">
<CENTER>
<H1>寵物檔次計算機 Ver 0.98</H1>
</CENTER>
<FORM NAME="choose">
<DIV id="myDiv" style="position: relative; left: 10px; top: 0px;background-color:#FFFFFF">
<div align="center">
  <center>
<TABLE BORDER=5 BGCOLOR="#FFFFFF" bordercolor="#6699CC" style="border-collapse: collapse" cellpadding="0" cellspacing="0">
  <TR>
    <TD WIDTH=110px NOWRAP>
      <small>等級</small>
      <INPUT name="ptLevel" type="text" size=3 maxlength=3 value="1"><BR>
      <small>種族:</small>
      <SELECT name="raceMenu" onChange="loadMenu(this.selectedIndex-1);" size="1">
         <OPTION SELECTED VALUE="-1">全種族
         <SCRIPT Language="JavaScript">
           <!--
             for (var i in raceNames) {
               document.write('<OPTION VALUE="' + i + '">' + raceNames[i])
             }
           //-->
         </SCRIPT>
      </SELECT><BR>
      <CENTER>
      <SELECT SIZE=7 NAME="ptMenu" onChange="loadData();helpMessage()" onfocus="helpMessage()" onblur="helpMessage()">
        <OPTION SELECTED VALUE="-1">寵物名:
        <SCRIPT Language="JavaScript">
          <!--
            for (var i in Pts) {
              document.write('<OPTION VALUE="' + Pts[i][0] + '">' + Pts[i][1])
            }
            //choose.ptMenu.selectedIndex=0
          //-->
        </SCRIPT>
      </SELECT></CENTER>
      <font size="2" color="#FF0000">若標示為(缺)表示無法正確計算</font>
      <TD>
      <DIV id="sim" style="position: absolute; left: 140px; top: 50px;visibility:hidden;background-color:#FFFFFF;xIndex=100">
      <TABLE BORDER=3>
        <SCRIPT Language="JavaScript">
          <!--
            document.write('<TR><TD></TD><TH>0</TH>')
            for (var col=1;col<5;col++) {
              document.write('<TH>-' + col + '</TH>')
            }
            document.write('</TR>')
            for (var row=1;row<6;row++) {
              document.write('<TR><TH>' + BPNameList[row-1] + '</TH>')
              document.write('<TD><INPUT TYPE="radio" NAME="BP' + row + '" VALUE="0" CHECKED></TD>')
              for (var col=1;col<5;col++) {
                document.write('<TD><INPUT TYPE="radio" NAME="BP' + row + '" VALUE="' + col + '"></TD>')
              }
              document.write('</TR>')
            }
          //-->
        </SCRIPT>
      </TABLE>
      </DIV>
      <DIV id="classCalc" style="background-color:#FFFFFF">
      <TABLE border=3 bordercolor="#6699CC">
      <TR>
      <TD ROWSPAN=2>
      <TEXTAREA COLS=56 ROWS=10 WRAP="off" NAME="input" onChange="notDone()" onfocus="helpMessage()" onblur="helpMessage()">
可同時驗算多隻同等級寵物檔次&#12290;
使用方法：
先選擇左邊需要計算的寵物名，再於本格中依序填入
能力值: 血量 魔力 攻擊 防禦 敏捷 精神 回復 及
BP值: 體力 力量 強度 速度 魔法. (精/回/BP可不填.)
輸入範本(單隻寵)：
98 65 41 40 29 99 103 4 6 5 3 1
或(多隻寵, 每行一隻寵)：
98 65 41 40 29 99 103 4 6 5 3 1
100 72 41 38 29 99 103 5 6 4 3 1
      </TEXTAREA>
    </TD>
    <TD VALIGN='bottom' ALIGN='left'>
      <SELECT SIZE=0 NAME="outputType" onChange="notDone();helpMessage()">
        <OPTION SELECTED VALUE="0">顯示摘要
        <OPTION VALUE="1">顯示明細
      </SELECT>
    </TD>
  <TR>
    <TD VALIGN='bottom'>
      <INPUT TYPE=BUTTON ALIGN=CENTER VALUE="清除數據" onMouseOut="helpMessage()" onMouseOver="printTo('helpText','點此清除數據...')" onClick = "clearInput()">
      <INPUT TYPE=BUTTON ALIGN=CENTER VALUE="複製計算結果" onMouseOut="helpMessage()" onMouseOver="printTo('helpText','點此複製計算結果至剪貼簿...')" onClick = "copyDiv()"><BR>
      <INPUT TYPE=BUTTON ALIGN=CENTER VALUE="還原數據" onMouseOut="helpMessage()" onMouseOver="printTo('helpText','點此還原被清除數據...')" onClick = "restoreInput()">
      <INPUT TYPE=BUTTON ALIGN=CENTER VALUE="計算能力範圍" onMouseOut="helpMessage()" onMouseOver="printTo('helpText','點此計算全寵物能力範圍列表...')" onClick = "printStat()"><BR>
      <INPUT type="checkbox" name="showPic" onClick=loadData() CHECKED value="ON">顯示圖片<BR>
      <INPUT type="checkbox" name="clearOutput" CHECKED value="ON">計算後清除上筆結果<BR><BR><BR>
      <INPUT TYPE=BUTTON ALIGN=CENTER VALUE="開始計算" onMouseOut="helpMessage()" onMouseOver="printTo('helpText','點此開始計算...')" onMouseDown="printTo('helpText','計算中...')" onClick = "calculate()">
    </TD>
  </TR>
  </TR>
  </TABLE>
  </DIV>
  </TD>
</TABLE>
  </center>
</div>
</DIV>
<DIV id="helpText" style="position: relative; left:10px; top:20px;">請選取欲計算的寵物.<HR NOSHADE COLOR="#6699CC"></DIV>
<TABLE>
<TR><TD><FONT FACE="細明體,Courier,System,MS Sans Serif">
<DIV id="data_area" style="position: relative; left:10px; top:20px;">
<TABLE><TR><TD><B>圖鑑編號:</B></TD><TD>&#12288;</TD></TR><TR><TD><B>寵物名:</B></TD><TD></TR><TR><TD><B>種族:</B></TD><TD></TR><TR><TD><B>技能欄:</B></TD><TD></TD></TR><TR><TD><B>總成長:</B></TD><TD></TD></TR><TR><TD><B>出沒地點:</B></TD><TD></TD></TR><TR><TD><B>一級點:</B></TD><TD></TD></TR></TABLE>
</DIV></FONT></TD></TR>
</TABLE>
</FORM><HR NOSHADE COLOR="#6699CC">
<NOBR>
<DIV id="myDiv3" style="position: relative; left: 0px; top: 0px;">
</DIV></NOBR>
<SCRIPT LANGUAGE="JavaScript1.2">
if (Date.parse(document.lastModified)!=0) document.write("<BR>最後更新時間: " + document.lastModified +"<BR><BR>")
document.write("討論請至 巴哈姆特 (<b>bbs.gamer.com.tw</b>) CrossGate-T板<BR><BR>")
document.write("by <I>射手星系</I> - 風某")
</SCRIPT>
<Script src="http://app.myweb.hinet.net/counter/citycounter.asp?uid=myan&style=led&width=5"></Script>
<HR NOSHADE COLOR="#6699CC">
</BODY>
</HTML>
<SCRIPT language="JavaScript">
<!--